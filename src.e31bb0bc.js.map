{"version":3,"sources":["picture.js","utils.js","components/picture-canvas.js","app.js","tools.js","components/load-button.js","components/save-button.js","components/undo-button.js","components/redo-button.js","components/reset-button.js","components/tool-select.js","components/color-select.js","components/index.js","index.js"],"names":["Picture","width","height","pixels","x","y","copy","slice","color","Array","fill","drawPicture","picture","canvas","scale","ctx","getContext","fillStyle","pixel","fillRect","updateState","state","action","elt","type","props","dom","document","createElement","Object","assign","children","child","appendChild","createTextNode","hex","n","toString","padStart","cached","data","localStorage","setItem","JSON","stringify","getCachedState","parse","getItem","done","map","redone","SCALE","PictureCanvas","pointerDown","onmousedown","event","mouse","ontouchstart","touch","syncState","prototype","downEvent","onDown","button","pos","pointerPosition","onMove","move","moveEvent","buttons","removeEventListener","newPos","addEventListener","domNode","rect","getBoundingClientRect","Math","floor","clientX","left","clientY","top","startEvent","touches","preventDefault","end","PixelEditor","config","tools","controls","dispatch","selectedTool","tool","drawFunction","Control","reduce","a","c","concat","e","undo","metaKey","ctrlKey","code","redo","ctrl","draw","drawPixel","drawn","rectangle","start","drawRectangle","xStart","min","yStart","xEnd","max","yEnd","push","circle","drawCircle","radius","sqrt","pow","centerX","centerY","distance","triangle","drawTriangle","x1","y1","x2","y2","deltaX","abs","deltaY","signX","signY","error","error2","around","dx","dy","targetColor","length","some","p","pick","LoadButton","_","onclick","startLoad","input","onchange","finishLoad","files","body","click","remove","file","reader","FileReader","image","onload","pictureFromImage","src","result","readAsDataURL","drawImage","getImageData","i","r","g","b","SaveButton","save","link","href","toDataURL","download","UndoButton","disabled","RedoButton","ResetButton","confirm","reset","ToolSelect","select","value","keys","name","selected","ColorSelect","INITIAL_STATE","empty","doneAt","baseTools","baseControls","historyUpdateState","pop","Date","now","startPixelEditor","app","getElementById"],"mappings":";;AaAA;;AACA;;AACA;AVFA,AQAA,ANAA,AHAA,AMAA,ACAA,AHAA,AIAA,AHAA;AMWA;AVVA,AEAA,AHAA,AIAA;AOWA;AZZA;;;;IUEagM,AHAAV,ACAAC,AFAAH;AICX,AHAA,ACAA,AFAA,sBCAY/J,ADAAA,CIAAA,AFAAA,IDAZ,ADAA,CIAA,AFAA,ODAiC,ADAA,CIAA,AFAA;AEAA,ATAnC,AMAmC,ACAA,AFAA,ILA7B8B,AIAO2H,IEAUpF,ACAAA,AFAAA,CLAZ,GAAG,EAAd,EMAmC,ACAA,AFAA,QCAZA,ACAAA,AFAAA,QCAY,ACAA,AFAA;ADCjC,AFJF,sBEIcrE,KAAZ,EAAmB;AKDc,AHAA,ACAA,AHCd,ACDc,AHFnC,AHCA,ICGa+B,ISFUsC,QAAY,QAAZA,QAAY;ATGjC,AFNF,AIEA,AHCA,yBCGc9E,OAAZ,EAAqByC,WAArB,EAAkC;ASHD,ATGC,AMFhC,ACAA,AHAiB,ACAjB,APHJ,AIEO,AHCP,SOAS3B,ACAAA,AFAAA,AHDOgF,GICZ,ACAA,AFAA,CHDG,CAAc1C,CICN,ACAA,AFAA,EHDR,EAAmB3C,KAAnB,EAA0BqE,KIE3B,ACAA,AFAA,GHFC,EAAoC,GIC5B,ACAA,AFAA,ECET,ACAA,AFAA;ACCE4D,ACAAA,AFAAA,APLR,AIEE,AHCK,MOECA,ACAAA,AFAAA,GNFQlI,EGDLuF,EIGI,ACAA,AFAA,ECAE,ACAA,AFAA,KHHf,AHCK,CAAqBtF,KAArB,CGDwBA,CHCIC,IGDjC,EKGqB,ALHe,AHC/B,EAAoC;AUDvC,ATEgC,AMCnB,ACCP,AHHN,ACEa,AHHqB,AHEpC,IDHWtB,IICUI,COAdoJ,ALCA5I,AFD6B,KOAlC,CHGmB8E,ADAAA,CDFnB,CKDa,APAMtF,CAAe,CECnBiB,IEEY,ADAA,CCAC,AFFR,ACEQ,CDFPT,OAArB,CKDiB,OAAJ,CVEHS,CUFgB,IVE5B,GAAsBC,MAAtB;AUDIE,AHE4BgF,ACExB,AHHN,ACC8BJ,APHhC,AIAoC,AHGrC,MUFK5E,EPDoBnB,CEEjBqB,AFF6B,COC5B,AHEwB8E,ADAAJ,EIFtB,AFIEoF,AHHV,EECkC,ADAA,CDDvB,CECyB,ADAA,CHHdnL,CAAY,COAR,AFKT,ATLPJ,CSKQ,ITLpB,EAAmBC,KMGf,CNHJ,EAA2BC,KMEd,CNFb,CMII,CNJ+B,sBSKhB,CAAX,EAA2D;AEH/DyL,ATCF,AMA4B,ACGpBlG,AHDJ4D,ACFwB,APHK,AICjC,AHIJ,MUHMsC,ALGEtC,EFJA1C,CFEClF,AMAsB,ADAA,CCAd,ACGLgE,AFHK,CIDN,CTCP,CSDSrE,ALGE,AFJF,EFEE,AIEE,CFJD,EOCE,AFIE,CEJDb,AFIE,KENS,OTGX,QAAJ,EAAc;ASAvBiJ,ATCAnG,AMDW,ACGMmI,AHDN,ACFA,AHFCrL,AHKlB,MUHMqJ,ATCAnG,AEHYlD,CICZ,ADAA,AHDa,EAADA,CAAF,EKKOqL,EEHT,CLES,CKFP,CTCC,AOEW,EPFT,AOEW,CHDH,CAACV,IAAL,EAAN,aJDGxH,KAAD;ASDH,ATCG,AMAX8H,ACEa,AHDJ,ACDTA,APHJ,AIAiBhL,AHMrB,ISTaqL,EFMLL,ADAAA,AHHahL,CAAC,EJAbJ,AIAYI,CAAL,CKKI,CAAR,EDFI,ADAA,APHZ,CWEkBqF,ATCQ,CMAZrE,ADAAA,CPHDpB,GEGiB,CAACuD,AMAZ,ADAA,CCACN,ADAAF,APHpB,CWE0B,CAAC,ETCD,AKAZ,CLAuBO,AKAZyF,CCAX,CAAaA,GNAD,CKAZ,CLA8B3F,CMA9B,CDAoB,ECAE,ONAV,CAAX;ASDc7C,ATCd,AMFb,ACKK,AHHL,AILJ,AHGI,APAF,AIDoBA,KIDT,AFEA,ACFA,CHCSA,CFEK,AMGvB,AFCA,ACDA,EPJGN,CWCwBM,CPFJ,EAAEa,EOEO,AHHvB,ADAA,APEX,CQFA,AFEW,ACFX,CIGoC,ALDpC,CNAcnB,AIDkB,CAACM,GOEO,ADJ9Ba,CCI+BmI,CXDzC,GUHF,CCIsC,CAAWoC,MDJT;ACIX,ATEzBnI,AMGH,ACAM,AHCN,AIVuC,AHSvC,APLC,AIFY,ICFH2F,CDET,CFIE3F,COHA,EECwB,AXArBtD,CWAO,KXAZ,GEEc,AFFAA,EEEE,IFFhB,kBEEiBoD,KAAD;ASFJ,ANHd,AHKkB,AOIZ8H,AICR,AbNG,AIFC3F,AHMG,IYEDuG,ATRFvG,EKOI2F,GRDQ9J,GGNJ,AHML,CGNM,AHMOC,CQCJ,CPJe,COIb,CAACH,AICA,AZFZ,EAAmBI,CCHS,AWKb,CXLciC,CGLtB2F,AISU,CJTtB,AISuBrG,CRDlB,ECHwB,ADGe,CCHJO,AOIvB,CAAWyF,GJTC,CHKA,EAAkB3F,WAAlB,CAAX;ASLU,ANAC,AHKX,AOHd,ACHoC,AGYxCuC,ATTahF,AHOb,EYEAgF,EVZWN,CQCI,AFAF,CEAX,AEWE,ATTS1E,AHOTc,CQEA,CJXagE,AKDIF,AGYf,CZFC,GAAG7D,CSV8B,ANGpB,CSQA,CTREN,CCFO,CIAhB,CAAX,ELEyB,AHOT,CSVGmE,ANGO5E,AHOTgB,GITF8D,EKDuB,ENGlB,CAAcgB,GCFP,CDEP,CAAmB,AHO/B,CGPgCE,AHOTpF,IAAvB,CGP+B,AHOzC,CGPsB;ADFtB,AQKE,ATFyB,AOU1B,ACduC,AGaxChB,ATVW,ESUXA,GXTa,AEDH,CFCR,AEDA,CSUG,CHbuBkF,CCMrBhE,AEOA,GFPL,GAAW,CDN2B,EGWpB,KVVRL,CODgBqE,IPC5B,EAAmBH,CQKF,CDNuB,IPCxC,EAA2B,AQKd,EAAa,IAAb,EAAmB,YAAnB,EAAiC,KAAKiE,KAAtC,CAAX;ARLyB,AQM1B,ANN4B,AHO3B,AWMF5I,ATVC,AHOD,EYGAA,CTdyC,CAKzC,EHMIa,GCHGkC,AWMA,ELHP,AFCA,ACDA,AMGS3D,AZHT,EAAW,KCHT,CAAeY,OAAf,CIIK,EOEUsL,CLHP7K,ADAAA,IMGD,CLHT,ADAA,AMGuB,ELHN,ADAA,AMGR,EAAkB,EAAlB,EAAsB,SAAtB,CAHW;AFFpB,ATAC,AMGC,AFCA,AIbsC,AHYtC,AMGF2B,AZHEnB,EYGFmB,EZHEnB,EYGE,EAAE,EPFAhB,AOFc,AZCZ,COADa,ADAAA,APAP,ACASI,GOAP,ADAA,CCASuJ,ADAAA,CDCC,CLDV,CAAc3J,CKCD,ELDb,EOAA,ADAA,ANAmBD,GOACJ,ADAAA,APAhBjB,CAAN,CCAE,CDAOC,CAAT,CQA2B,ADAA,CCAC6C,ADAAF,APAhB,GMCO,CCDG,CAAWgG,CCAX,CAAaA,IFCpB,ACDO,CDCpB,CEDoB,CDAoB,CAAxC,CCA0C,CAA1C;ALXyB,AQS7B,ANRI,AGWD,AFCC,ACDD,AMGD9F,AbHE,ACAD,EYGDA,MAAM,CRdCxB,CQcC,ERdN,AQSkB,CbEX,EKXI,GLWCvB,MAAL,CAAYC,CAAC,GAAGC,CAAC,CKVtB,CCWU,CNDe,IMCVO,CNDeX,CKXrB,EAET,ELSK,CMCP,ANDA,EMC0BY,MAA1B,EAAkC,EAAlC;AKHJ,ANNQyI,ACUJ,AIdA,AGgBF6C,AbHC,AIRDxF,ESWAwF,ATXAxF,ICDM2C,EQYA,CHhBCqC,CJcDX,AOEE,CJDR,ALVS,CAAChH,CCDG,CCUH,CDVK,AKJb,ANKO,EESI,AFTE3C,CMLCE,INKP,CAAT,OKUUF,GHDO,EGCjB,CHDa,CGCI,CHDK,MIblB,QADY,EAEZ;APDF,AQUJ,ANPiB,AIYb,AHDE4J,AIZExB,AGOc,ATJpB,AHE4C,CYE9C,KHPQA,EPFEjE,AGcJyF,CFTGtE,EKUAjF,CHDC,CHdN,CMeA,AHDQb,AIZI,CLCO0I,AIYV8B,CNf2B9F,AOEtB,ENGhB,EESgB,CAAC2F,CHdf,CAAM1F,AMeN,CJZ4B,CAACE,CIYT,CAACrE,CNfrB,EGcQ,EGCkB,AHFN,CDVQ,AIYD2B,CJZd,EJImBjB,CQQX,CAAWiH,MAAhC,ARR0C;AEP1C,AEGa,AIad,AHDGmC,AIbY,AGgBlB,ATZC,AHCmCpJ,IYW9BqK,AZX8BrK,IEPnB0D,AGeX0F,GJNJ,CDF4C,CYW/B,EHhBSzF,CPFpB,AGeU,AOGI,EPHF,CHfwBH,IOER,CAAC,CPF7B,CAAaE,IDSL7E,ICTR,GDSF,EAAmB;ACTjB,AEEE,AHQF,AIGoB,AIXWgF,AGiBjCc,ATXF,AHD8C,EYY5CA,GRnBa,CQmBT,CRdA,ACQS,CHbYhB,AGavB,AOMFgB,EXTM,AQR2Bd,CVYjC,GUZqC,CRQ1BhF,CCVT,AEAW,AKE0B,CLFrC,EFAoC2E,AUkBtB,EHhB2B,CRQrC,AQRsCoG,GPF1C,AHcGxL,CGdoBuF,ADUH9E,EQRiB,CAAYgL,EVYnD,EEJE,AFIW,CGdX,CDU6B;ACT7B,AEMD,AHIC,AIMAjK,AIf6B,AGkB/BjB,AbLE,AINJ,ESWEA,IPHEiB,AOGE,EAAJjB,CVnBOW,AOCuB,CAAd,AVaVf,CEJCM,GCVL,AGgBQ,ANFA,CMECgJ,EHhBIvI,AHcF,CEJX,CIMA,AOCc,CPDAY,CJNCrB,CCVf,AHcgBT,MEJhB,AFIW,CAAYI,EMEvB,CAA0ByK,ENFf,EMEX,ANFA;AGbA,ADUA,AIMAA,AIhBc,AGmBhB7B,ATXF,AHEE,EYSAA,IPHE6B,AOGE,EAAJ7B,CVnBOtI,CGgBD,CAACgJ,IHhBL,CGgBA,EHhBc,CUgBA,GVhBIzG,SFUFrB,CCAJ,KAAKnB,EDAnB,KCAE,EAA0B,ICVZ,CAAkBS,ADUDK,GAA/B,ECVqC,ADUDyB,CCVEvC,IDUtC,GCVc,EAAiC,IFUrB,MEVsBoD,GAAD,EAAS;AACtD,ADUH,AIMCgH,AIlBE,AGqBJnE,AbRa,ACFR,EYULA,GHvBgB,CJoBdmE,ELPOhJ,EETD2D,AGgBF,CKRN,ALQOmE,AOGE,EAATjD,AZVc,IKOZ,KHhBkB,GAAGrB,IUeP,AZNX,CETuB,AQQlBnE,CRRmB,EOCtBQ,ECOP,CRRiC,CAACR,AQQjB,EDPJ,CAACwK,EPDe,CAAWjG,COCjC,CAAYJ,EPDS,CAAxB,CADsD,AHc5BrF,CGZ1B,AOAG,EAAmB8C,GAAnB,AVUM,CUViB,UAAC6I,IAAD;ACQ5B,ALQD,AIhB6B,AGmB9BvE,AbTa,EaSbA,MAAM,EAANA,CFXOiC,EDPD,GCOJ,CAAWoC,KAAX,CEMc,EFNKvK,IDNb,CCMkB,CAACb,KAAzB,CDPI,EAEE;APFJ,AQQH,ADLSuL,AGgBVhE,ATbK,AHEH,EYWFA,MHhBUgE,ATKJ,CGFQlF,CDNNhB,AUmBA,CRfR,CQeAkC,GZXa/F,CSLK,EAAE8J,ANGf,CAAmBhF,CHElB,EERc,AOGI,ENGnB,CDNkBnB,AFQA,CSLKtE,ANGGA,KMHE,ANG5B,CCFO,AKDsBuE,CLEhC,ADCoCF,AHEpC,EAA+B,EERE,CAAC1B,GAAD,ACM9B,EDNoC,ACMO,KDNH,CAAC3C,KAAX,EAAkBqE,QAAlB,CAA/B;AEMH,AKJO,AGWQ,AbJH,AIFb,AHEIhE,CYIN,KZJMA,CSTE,EAKEoK,ATID,CAAC7J,CGFC8E,EMPH,CADwB,OTU1B,CAAgB/E,EGFpB,CAAuBgC,EHEnB,CGFJ,EAA4B;ADNxB,AOF0B,AGuBhC,AbXI,AIHA,AHEC,IYYCqI,CHvBG,ATSL,CSdc,ENcVrF,CMdJ,CPOMnB,CGgBR,ALPS,GGFG,EScI,CTdDjB,EScI,CACnB8G,CTfmB,CDPf,ACOgBzE,EDPE,CCOP,CAASH,IESdzF,CFTmB,CAACjB,CAAf,EESf,AFTiC4D,EEShB,CFTmB,CAAC5D,CAAtB,CAAb,CSciB,EAEnB4L,gBbbsC,OaWnB,EAGnBlB,sBAHmB,EAInB1B,sBAJmB,EAKnBgC,sBALmB,EAMnBE,sBANmB,EAOnBC,uBAPmB,CAArB,EAUA;AV9BQ,AGgBJ,AITA,AVEoC,AIFpC,AHEE7J,MAAAA,EGFEwF,CMACxF,ATEA,CAACO,CKODrB,CITL,ENAU,CMAC,ENAEgE,CESb,GAAevD,AFTE,AHEf,CGFgB4F,AHEAtF,GGFL,CESO,AFTEmF,CESDlG,GLPK,CSFX,ANAY,AHEAsB,CGFC7B,CAAf,CESb,CFT+B2D,GMApB,ANAuB,CAAC3D,CMAX,ANAX,CAAb,GMAW,CTEO,CSFY,ATEY2B,KAAxB,CAAhB,ESFS,EAA6B,KAAK2J,MAAlC,CAAX;APNI,AGgBL,AITA,AGuBH,AbtBwC,AIDpC,AHEC,QGFGxE,CSuBCmF,GTvBG,EJCGlM,CGRA,AHQyB,AIDzBwE,IAAI,CAACwC,GAAL,CAASN,CDPR9C,EU8BhB,CV9Be,AU8Ba3C,CTvBC,CJCdjB,AIDeA,CJCU,AIDzB,ESuBf,ATvBiC4D,ESuBE1C,CTvBC,CAAClB,CAAtB,CAAX,ESuBJ,EAA2C;AV9B5B,AOSb,AGsBA,AbvBsC,AIApC,AHED,MYqBGkB,ETvBE+F,ISuBI,ATvBA,CSuBCjB,CbvBK/F,CAAsB,AIAzBuE,EDRSiB,AU+BtB,EAAiB,ATvBA,CAACuB,GAAL,CAASN,KDRY,ACQP,CDRQ9C,AHQnB3D,AIAYA,CJAU,AIAzB,EDRqB,ACQH2D,EDRS,CCQN,CAAC3D,CAAtB,CAAX,CDR0C,CAACgB,KAAX,CAArB;AAAA,AEMf,AHEA+B,AQEA,AGsBI,AbxBoC,AICpC,QSuBI/B,ATvBAuF,CDTA,IDQK,AWwBA,ATvBA,CFDChD,AWwBAZ,AbxBOxC,EICL,ESuBR,ATvBJ,CSuBewI,AbxBqB,IEAxC,CAAwBxF,CWwBhB,GAAoB,CXxB5B,AWwBI,EAA2B,CXxBC,EFAXhD,IawBiBa,CbxBE,GEAEwC,CWwBX,QXxBC,EAAqBC,MAArB,EAA6B;ACPtD,AEMP,AHC6D,AQG7D,AGsBI,AbxBExD,ACEJ,QYsBM4C,CZtBCxB,CDFHpB,ECEJ,EYsBY,AbxBJ,CAACF,CAAC,CawBKiB,EbxBFhB,CAAC,EawBM,CAAC2C,AbxBJ,IawBF,CAAWuJ,AbxBJtM,GawBP,EAAb,AbxBM,CAAJ,GAA2BO,KAA3B;AGPD,AEML,AKIA,AGsBI,AbxBC,AIAD,AHEH,KElBiB,CAAd,GCgBK,ESwBE,ETxBEH,CAAC,GAAG6G,MAAb,EAAqB7G,CAAC,IAAIgH,IAA1B,EAAgChH,CAAC,EAAjC,EAAqC,qBSyBhCgB,KADE;AV/BP,AEMJ,AHAE,AW2BIT,Ab9BS,AIKT,AHGN,MYsBMA,GVjCG6E,ECQE,ESyBE,EAAEpE,ATzBAjB,CAAC,CDRZ,ECQe4G,CDRCvB,AUiCA,CAACzC,IAAN,ATzBT,CSyBoB3B,CTzBCjB,CDRC,ACQA,CDRC6C,EUiCE,CVjCX,AUiCYD,ATzBAmE,CDRC,GUiCP,ATzBpB,CSyB+B6B,CTzBC5I,CAAC,EAAjC,EDR4B0F,AUiCR,ATzBiB,GSyBG,CAA/B,CAFJ,EV/BsB;AAAA,AShBjC,AVuBE,AW2BI9C,Ab/BS,AIMP4D,AHGR,MCLM/C,AW2BAb,ETzBE4D,ESyBE,GVlCoC,ACSjC,CAACU,CFFC,CAACvD,CCPkC+B,CCS1C,CAAW,GFFb,ECPwC,CAAYzE,CDOhC,CAAxB,EAA2B,CCPiB,CUkC9BA,CVlCiDkE,IUkC5C,CAACvC,CVlCwB,CAAb,EUkCvB,CAHC;AV/BsB,ADQ/B,AW2BIE,AbhCS,AIMM9C,AHIrB,KEboB,CAAhB,ADQE4D,AW2BAd,GX3BG,CECY9C,CAAC,CFDV6D,AW2BA,CT1BS7D,CAAF,aFDQ,CAACyD,SAAD,EAAY,IW2BrBxC,CX3B0BK,GAAjB,CAAzB,AW2BqB,CAACwB,MAAZ,IAAoBA,MAApB,EAJD;AV9BP,AShBJ,AVwBE,AW2BIiJ,AbjCS,AIMS9L,AHKxB,MCLM6D,AW2BAiI,GVnCGzK,CCQerB,CAAC,CDRrB,ADQQ,AW2BA,CT3BYA,CS2BV,AT3BK,CDRJkB,ADQAuC,MAAM,CAACE,GAAD,CAAnB,eCPI,KADS,EAET,EAFS,EAGT,KAAKnD,MAAL,CAAYa,GAHH,EAIT,gBAAI,IAAJ,CAJS,4BAKN,KAAK+D,QAAL,CAAcM,MAAd,CAAqB,UAACC,CAAD,EAAIC,CAAJ;AAAA,ADI5B,AWqBS,Ab5BI,AIMYzF,MFCrB,CAAC0D,AWqBH,GTtBuB1D,CMCzB,EPJsCwF,ADItC,CCJuC,CAACE,ADI3B,AEDiB,EAAE7E,IDHM,CAAS,ACGV,CAACb,EDHA,EAAcyF,CAAC,CAACvE,COI5CL,EPJ4B,CAAV,EOI5B,EAAiB;APJW,ASpB9B,APqBA,AKII,AG2BD,AT7BgB,KDHV,EAAqD,EAArD,AECAkI,ADED,CDRO,COUNoC,EPVL,IOUA,CLJJ,AKIgBC,CLJGlG,IKIf,GAAoBrE,CLJxB,EAA6B,EKIA,CAACuE,IAA1B;APHAjE,AEAF,AHIA,AQAC,AVJC,AIEG,AHKA,IEPHA,EEAE6H,AHIArF,GDGUhC,CCHN,CGJC,CFAC,AFOL,CEPMqC,ADIA,AFJF,ACOSpC,CIPN,AJOP,EAAgB,CDPRpC,KEITmE,EFJK,CAAY,CEIV,CAACC,ECJV,CAA0B,AEAZ,ALAUnE,KAAjB,CEIE,CGJC,ALAqB,CEIP,CCJxB,AEAuB,EFAc,CHADC,MAA7B,EAAqCI,CGAN6F,CAAD,EAAO,AHArC,CAAP;AGCEA,AStBN,APsBI3E,AHIA,AW2BF,Ab/BC,AIEE,AHKH,IIPEA,EFAE2E,AU+BA7E,CV/BC,CAAC8D,AEAA,AHIAhB,CDGChC,CIPC,AJOA,CAACC,CYwBC,CAACmE,GRhCc,CHKV,AW2Bf,CX3BgBnC,CW2BC,AZxBV,CAAW,EEPd,AFOG,EAAe/B,CCHhB,IAAqB,CAAzB,EAA4B,ADGvB,CAAwB,CAAxB,EAA2B,GAA3B,CAAP;AENIoD,AEAF+D,AHIE,AW2BF,AZxBH,IIPGA,EFAE/D,ADIA,EW2BErE,IR/BI,AHIF,CAACK,AW2BE,CV/BC,AEAA,AQ+BAwB,CV/BC,CDIT,CAASoB,GW2BP,CAAa0E,MAAb,GAAsB,CAA1B,EAA6B,GX3B3B,CAA6B,GW2BK3H,KAAP,GX3B3B,EAA0C8C,IAA1C;ACHEiC,ASvBR,APsBc,AHKT,AW2BD,AT9BAV,AHOJ,IGPIA,CFCA,GCFIU,AU+BAxF,GX3BG,CCJC,ACCA,CCFQ8I,ADEP,CDDC,CAACvD,AU+BA,CV/BC,CAACE,CU+BChF,KRhCY,AQgCP,CV/BR,AEDgBmI,AQgCPtG,IV/BIiD,CAAC,AEDO,CFCNG,AEDOqD,AQgCnB,CAAa4C,GAAb,CRhCa,CAAY,AQgCvC,CV/BU,AEDiB,CAAD,EAAiB7G,EFCLS,CAAC,CAACI,IAAF,AEDZ,CAAhB,IFCuC,MADtC;AAEPC,AEFM,AHMR,AW2BF,AT/BW5F,AHQf,MGReA,EDAP4F,EDIEjC,CW2BC,AbjDT,CGkBU,CCAU,CDAR,CAAC4B,ACAS9E,CDAR,ADIA,CCJCgF,EDIEpC,CEJU,CAACrD,GDAf,EHlBAX,EGkBakG,ACAJ,CDAK,ACASO,CDARJ,CHlB5B,EAAoBpG,AIkBE,CFIU,AEJS0G,CFIRxC,ECJrB,EHlBZ,AIkBsB,EJlBM5D,CGkBY2F,CAAC,CAACI,ADIV,EAAY,AFtB5C,EGkBwC,AHlBL,IEsBa,CCJG,ADIF7E,GAAjB,CAA5B,KW4BGL,KADE;AVjCI,ASrBf,APmB2B,AHSrB,AW4BAT,AblDF,AIiBS,AHSb,GIbc,CAAZ,CDIU,CSiCNA,ATjCF,CDFU,CAAR,EDOI2D,AFtBFpE,GakDK,EAAPS,CX5BU,AFtBF,CEsBGR,CAAP,CFtBO,GEsBK4D,AW0BX,CbhDUvD,EEsBI,CAACL,CAAhB,CFtBO,CAAUH,EEsBIsE,GFtBC,GEsBK,AFtBFrE,CEsBGG,CAAP,IAAY2D,AFtB1B,EAA0BtD,CEsBG,CAACL,CAAzC,CFtBW,CEsBiC,AFtBFG,KAA/B,CAAb;AGmBC,AEFHmB,AHMIuC,AW4BAlB,AblDF,AIiBD,ECDDrB,GFJE,CDUEuC,AW4BAlB,IRlCI,AQkCA,CRlCC4G,CHMC,CAACrF,AFtBF,EKgBT,CAActC,CLhBDjC,EEsBH,CAAN,IFtBK,CAAYC,EKgBrB,CAA0BuJ,ELhBjB,EAAmBtJ,CKgB5B,KLhBS,EAA2BC,CakDtBkB,KAAK,AblDV,CakDW2B,AblDlB,IakDM,IAAkBpC,OAAlB,EAHC;AV5BR,ASzBH,APuBE4I,AHMG,AW4BCtG,AblDH,EKgBDsG,IQkCItG,CRlCC,CAAC2G,IQkCI,CRlCV,oBQkCgBxI,KAAK,CAAC6B,MAAZ,CAJD;AR7BTsG,AHMC,AW4BG2C,ATlCJpF,AHQK,EIRLyC,ADAAzC,CFFA,GWoCIoF,CRlCC,CAACrC,CJQQvH,GY0BJ,ERlCV,AQkCY,CTlCC,AHQR,CGRSuE,AHQOtE,IAAhB,CGRQ,CAAb,AHQ2B;AW/B7B,APwBC,AQ4BU,AT5BT,AHQAC,EAAAA,KYoBE,ET5BKsE,KHQK,CAACrE,OGRb,AHQA,CAAqB,QAArB,EAA+BC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA/B;AINF,AHIE,AW6BC,ATlCF,AHQC,OCHKd,EDGEc,CCHP,CAASgC,EDGT,cCHA,CAA0B,WAA1B,EAAuCL,IAAvC;AGHF,AHIC,AEJD,AHOC,CCpBD,UCYE,mBAAU9C,KAAV,EAAiB;AACf,AECJ,AQiCE,ATjCF,AHQA,MYyBMC,KVlCGD,CUkCG,CAACoK,GVlCT,EUkCF,CVlCepK,CUkCG,IVlChB;AACA,AECJ,AHIA,AW6BI,ATjCJ,AHQA,QYyBQT,CX7BCqD,ECLApD,KUkCM,CVlCX,CAAY8C,CUkCE3D,KX7BlB,CAAyBgE,ECLrB,CAAsB3C,ADK1B,EAA8BoD,GCLC,CAAC7D,GDKhC,AW6B0BsL,EX7Ba,ECLnC,CUkCc,CAAc,EAAd,EAAkB,EAAlB,EAAsB,SAAtB,CAAd;ARhCJ,AHIE,AEJF,AHQA,MCJMxH,IAAI,GAAGD,OAAO,CAACE,qBAAR,EAAX;ACRiB,AEKnB,AHIE,AW4BE,Ab1CG,SEcE,AFdOhE,Ea0CL,Sb1CJ,CAAqBC,OAArB,EAA8BC,MAA9B,EAAsCC,KAAtC,EAA6C,IGQ/B,KAAK2E,QAHP,AUsCVpE,KADE;AVrCQ,AEMnB,AHIIjB,AW6BEQ,Ab3CJC,EAAAA,EEcET,CAAC,CW6BCQ,CX7BCgE,CFdC,CAAC3E,EEcE,CAAC4E,CW6BC,Cb3CX,Ca2CIjE,EX7BC,AFdUA,CEcC,CAACoD,GAAG,CAACc,AW2BZ,CbzCa,CAAC7E,KEcN,AFdF,GEcgByE,AFdA5D,IEcI,CAACiE,AFdpC,IEcgB,IAA4B5B,KAAvC,CADE;AGFT,AHII9C,AW6BE2C,Ab3CJnC,AIQK,AHQA,EDhBLA,EEcER,CAAC,CW6BC2C,CX7BC4B,CFdC,CAAC1E,AIQOqH,AHQA1E,CY2BN,CX7BC,CAACgC,AW6BA,EAHD,CbxCT,AIQK,CAAgBiC,CFMhB,CAAW,AFdAlG,CEcCoD,EENZ,CFMe,CAACgB,AENO3D,AHQvB,EDhBkB,CAACnB,ACgBO,EGR1B,EFMY,AENkBwF,EJRnB,CEcehB,EFdE5D,EEcE,CAACmE,AEN/B,EJRL,AIQ6C,CFM7B,IAA2B9B,KAAtC;ACXY,AEQnB,AHCS,AWgCHD,Ab3CJ,AIQA,AHQA,GCLA,GWgCIA,Ab3CAnC,ACgBAM,GDhBG,EIQEmG,AHQA,CY2BC,Ab3CA3G,Ea2CE,AZ3BA8B,IDhBI,ACgBA,CDhBC3B,ACgBA8B,EGRjB,CAAoBkB,EHQR,CGRZ,AHQuBvB,EGRE,EJRf,CAAkB,IAAlB,CAAV,ECgBmC,CAACM,OAAb,CAAqB,QAArB,CAAX,CAAZ;AEXE,ADUH,AWwBU,AT9BP,AHQF,MAAI,CYsBF,AZtBG1B,CGRGoG,IHQR,EGRc,AHQF,GGRK7C,IAAI,CAAC8C,IAAL,EACb,gCDL8B;AAAA,AUwCjC,Ab3CD,AISI9C,AHOJvD,EAAAA,EGPIuD,GJTC,ACgBA,CGPG,AHOF5B,CGPG2E,EJTAtH,CAAC,AISN,AHOJ,CGPa2D,CDNFyC,CHHE,ACgBApF,CDhBb,AISgB,CAACjB,CDNiB,AHHlBC,AISH,CJTI,CCgBC,CGPGyG,AHOF9D,CDhBCpC,GCgBP,CGPa,AHOFqC,CGPG7C,CAAvB,CJTuB,ACgBd,CDhBeF,AISE,AHQ5B,CGRE,IAA+B0E,CJTnC,EAAoCvE,CAAC,AISE,CAACsH,CJTxC,EAAyC,AISN,CAAS3D,GAAG,CAAC3D,CAAJ,GAAQyG,KAAK,CAACzG,CAAvB,EAA0B,CAA1B,CAFlB,CAAf;ADHEoG,AEKN,AHMArD,AFdI,AIUA,AHMA,QGNMwE,AHMH3H,CIREyJ,ALRA,CGGHjD,GDWO,AFdArG,ACgBT,CEbM,ADWIwD,AFdA,CGGHD,ACOM,EJVA,CAAb,AIUgBmD,CCFpB,CAAoBiD,ALRA3J,CAAC,ACgBdH,ECFP,AEJyB,CDPnB,AEKN,AHMwByD,AFdA9C,AIUER,CDPLiB,ACOD,CCFMqE,AJQtB,EGN0B+B,CFI9B,CCXM,CHHyB,CEcC,AFdAxH,EKQhC,ADEI,ECFgC,CLRhC,EAAmCG,CAAC,EEcE8E,AFdtC,EAAwC,QEcZ,EAAsBpB,MAAtB,EAA8B;ACVzD,AEKH,AHK4D,AW8B5D,Ab3CI/C,AIUF,AHKA,MIPEgJ,AQmCAzI,Ab3CAP,EIUI8G,AHKI3H,CDfL,CKQC,ALRAe,Ea2CE,CAACL,CRnCC,AJOV,CGLa,GCFf,ADEkBkG,CJVd,CKQc,AQmCd,Eb3CgBlG,ACeRV,CGLW,CSiCDmB,ATjCEhB,CAAN,GAAUoH,AHK1B,CY4ByB,Ab3CA,Ca2CC0E,Ab3CAjL,IIU1B,CJVkB,Ca2CE,Ab3CYd,CAAd,Ea2CiBoM,Ab3CAnM,CAAjB,CAAhB,Ea2CqC,CAACoM,GAAL,KAAa,IAAlD,EAAwD;AV7CvC,AEWjB,AQmCE,Ab3CE1L,AIUF,AHIA,MINEiJ,ALRAjJ,EIUE6F,AHIczG,CDdb,CAACgB,Ca2CC,CRnCC,CDEC,CHIT,CINW,CDEC,EJVV,AIUF,CCFe8I,ALRA7J,CAAC,ECcED,CDdCW,KAAjB,ACcF,CINW,CLReT,CKQ5B,ALR6B,GAAGS,KAA5B,EAAmCA,KAAnC,EAA0CA,KAA1C,uBa4CGO,KADE,GAEFC,MAFE;AV9CQ,AEYjB0I,AHIA,AWiCIhH,Ab7CD,ACaD,EILFgH,IHIIhG,AWiCAhB,ERrCE,CAACwB,AHIA,CWiCC,CZhCyB,CCDvBP,GDC2BjE,UILrC,CAAwB,CHIC,CAACkF,GDCO,CILjC,AJK6CjF,EILb,GJKC,CCDG,CAACkF,ADCejF,EYgCtCmB,IZhCmB,CILK,AHIZ,AWiCP,CXjC0B,AWiCzB2B,AZhCwC7C,CCDlC,CAAD,EAAwB,AWiCzC,EZhCyB,CAA/B,CYgCwBkB,CXjC4BK,GAA7B,CAAzB,AWiC+B,CAACd,OAAxB,EAHC;AV9CQ,AEaf,AHIF,AWiCI,Ab7CH,AISC,AHGA,GADW,CAAb,ECCIsD,EGJEgG,CDCC,GFGG,CGJC,ADCA7J,CAAC,CFGCyD,CGJC,CDCC+D,IFGI,CAAC7D,EEHE,CFGH,CAAnB,CEHyByD,KCDP,CDChB,EAA+BpH,CAAC,CCDpB,EAAW,CDCawH,OAAO,GAAGJ,MAA9C,EAAsDpH,CAAC,EAAvD,EAA2D;ADd5C,AEcb8J,AHIJjF,AWiCI,Ab7CL,AISK,AHIJ7D,ECDA6D,ADCA7D,IILI8I,CJKC,CAACjH,GGJG,CCDC,AHIA,CAACkC,CGJC,AJKZ,CGJahF,CAAC,CHICiB,EGJEuG,GHIG,CAAC1E,GGJG,CFGxB,EEH2BuE,AHIZ,CAAaxE,GAAb,CACb,CGLE,EAA+B7C,CAAC,IAAIwH,OAAO,GAAGH,MAA9C,EAAsDrH,CAAC,EAAvD,EAA2D;ADf9C,AEcL,AHKZ,AWiCI8C,ATpCE,AHIJ,MCDE,AWiCAA,CXjCCgB,CDCAjE,IYgCK,ATpCE6H,CFGZ,ADCE,CYgCU,CRrCNpC,AHIO,CW2BJ,IT9BW,EHIfzF,CILS,ADCS2E,CCDR,GDCY,AHIzB,CGJ0B8C,IAAL,EACf;ADXP,AEUO9G,AQqCJuL,ATnCIvH,AHEN,MYiCEuH,ETnCIvH,AHEI1E,EIJJU,EQqCE,ATnCE,CAAC+G,CSmCD6E,AZjCV,EGFM,CCFO,ADEEpM,CSmCD,ATnCE,CCFDgK,AQqCAqC,ETnCI7E,CSmCT,CZjCA1H,KGFJ,CHEN,CGF4B,CAAtB,ICFyB,ADEE0E,CCFDsF,GDEK,CAACvC,CCFP,EDEE,CAAStH,CAAC,GAAGwH,OAAb,EAAsB,CAAtB,CAFZ,CAAjB;ACDS,AHMf,AWyBS,AZ1BP,MCCE1D,CWyBF,CZ1BkBhE,CILN,CADF,AHOJ,GAAG,CDDT,QCCEgE,CDDgBhE,GCCT,CAACiE,EDDV,OCCS,EAAe;AGPd,AHQV,AWiCD,ATnCK,AHAJ,OIPuB,CHSnBG,GDF2B,CGAvBuD,EFEE,CDFyB9H,ECEtBiE,GEFG,IAAIwD,MAAhB,CHA2B,CCEH,AEFA,AHAexH,CCEdmE,IDFE,EAAmBlE,GCEZ,CAACiF,EDFR,EAA2BhF,GCE7B,CAAkB,CAAlB,CAAD,ADFG,CAA/B,CCEmD,MAAI,CAACuB,GAA5B,CAA5B;AGJE2I,AHKF,AEFMzD,AHDN,GADa,CAAf,EIDIyD,EHKE9F,CGLC,CDGCqC,CCHCoD,GHKG,CAAC5J,AEFA,CFEP,AEFQkH,CCHC,CAACgD,EHKEtG,AEFV,CAAW,EFEE,CAAC5D,CAAhB,IAAqBmE,MAAM,CAAClE,CAAP,IAAY2D,GAAG,CAAC3D,CAAzC,EAA4C;AGVrB,AHWvB2D,AWgCF,ATnCqB5D,AHCrBiB,EAAAA,ECEE2C,CGXY,CAAZ,CHWG,ADFA,CAACpD,CYkCC,CXhCC2D,EEHanE,CAAC,EAADA,AHCrB,CCEE,AEHiB,EHCH,IAAIJ,gBAAJ,CACdqB,KAAK,CAACT,OAAN,CAAcX,KADA,EYkCGoB,AZhCjBA,KYgCK,AZhCA,CAACT,EYgCqBU,KZhC3B,CYgCK,AZhCSpB,EYgChB,IZlCgB,EAGdmB,KAAK,CAACT,OAAN,CAAcT,MAHA,CAAhB;AIFC,AHKC+D,AWgCH,ATpCyB7D,AHMxB,GIfA,CHaE6D,KDEK7C,CCFC,CAACkD,CEJelE,CAAC,CHMzB,CGNwBA,CAAL,CFIX,CAAN;AGJF2J,AHKC,AEL0BxJ,AHO5B,EIPCwJ,CHAA,KGAM,CAACO,GDAoB/J,KAAK,EAAEa,GCAlC,CAAqB0I,CDAkB,CAACvJ,ECAxC;AACD,AQqCD,ATtCqB,SSsCZkM,ETtCC,cSsCV,OAIG;AXpCD,AWoCC,ATzCM,MFKHrH,GAAG,GAAG,SAANA,GAAM,GAAM;AGHlB,AHII,AELG,IFKH,KGJK+E,CHID,CAAC1I,GAAL,CAAS4C,UGJb,CAA0B4F,KAA1B,EAAiC,CHI7B,CAA6B,WAA7B,EAA0C/F,IAA1C;AGHF,AQsCC,ATvCE,MCCClE,KAAK,GAAG2E,IAAI,CAACqC,GAAL,CAAS,CQmCrB5F,ERnCY,EAAc6I,CQsCzB,IRtC8B,CAACjK,KAApB,CAAZ;AACA,AHGE,AWkCD,IXlCC,EGHEC,AQkCJmB,IX/BM,CAACK,AWkCN,CRrCS,EHGR,CGHWkD,AHGFN,IGHM,CAAC2C,GAAL,CAAS,GAAT,EAAciD,KAAK,AHG9B,CGH+BhK,AHGF,MGHlB,CAAb,GHGE,EAAyCiE,IAAzC,MW+BM,4BAGP,6DAH2B8H,aAG3B;ARpCD,AHGC,AWiCA,ATtCCvG,GFEF,CEFEA,ECEE7E,MAAM,ADFA,CAAC,ECEE,SQkCb2E,KAEC,ERpCgB,QAAJ,EAAc;AAAEvF,AQoC5B,ATtCYW,ICEgBX,EQkC7BuF,ATpCa5E,GCEqB,EAALX,AQoC5B,ETtCmB,EAAEoB,CCEK,IDFA,CAACT,OAAN,CAAc8F,IAAd,CAAmBE,ISoCjCwF,CTpCc,QSsCrB;ARpCmClM,AHIpC,AWgCC,ATtCU,ICEyBA,CDF1B,CAAR,CFMGwB,GGJqC,AHI1C,CAAS8C,CGJ2BtE,eHIpC,AW+BAuF,CX/B0B,OWgCzB,IXhCD,EAAuCtB,IAAvC;AGJ2B,AHK3B,AW+BC,ATrCA,GCCY,CAAb,EQmCAsB,CX9BK/D,GAAL,CAAS8C,GW+BR,aX/BD,CAA0B,UAA1B,EAAsCa,GAAtC,CW8BWgH,YACV;ARnCD,AHKD,AW+BC,CXjDF,KGaMtL,AQoCE4L,GRpCC,AQoCE,GRpCC9L,AQoCE,IAAIyE,ERpCA,CAACtE,UAAP,CAAkB,EQoChB,CAAgBK,CRpClB,CAAV,GQoCY,EAAuB;ARnCnCN,AQoCEyE,ATtCFgC,ECEAzG,ADFAyG,ESsCEhC,CRpCC,CAACgF,GQoCG,EAALhF,CTtCQ,CAACsB,ECEX,CAAcoD,AQmCqB,ETrCzB,CAAV,ECEA,EAAqB,CAArB,EAAwB,CAAxB;AACA,AQoCEzE,ATtCF,ISsCEA,ERpCEtF,GDFGqH,GCEG,AQoCA,EAAR/B,CRpCW,EAAb,CAN+B,CAO/B,ADHA,GSoCmC;ARhCnC,AQmCEC,ATtCH,ISsCGA,QAHiC,oBAGxBpE,MAHwB,EAGhB;AACfD,ATrCN,MSqCMA,KAAK,GAAGiL,kBAAkB,CAACjL,KAAD,EAAQC,MAAR,CAA1B;ARnCJ,AQoCIqL,ATrCN,MSqCMA,GAAG,CAAChJ,SAAJ,CAActC,KAAd,CRpCWN,GAAG,CAAC0J,YAAJ,CAAiB,CAAj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","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["/**\n * This class represents the picture in the canvas\n */\nexport class Picture {\n  constructor(width, height, pixels) {\n    this.width = width\n    this.height = height\n    this.pixels = pixels\n  }\n\n  static empty(width, height, color) {\n    let pixels = new Array(width * height).fill(color)\n    return new Picture(width, height, pixels)\n  }\n\n  pixel(x, y) {\n    return this.pixels[x + y * this.width]\n  }\n\n  draw(pixels) {\n    let copy = this.pixels.slice()\n    for (let { x, y, color } of pixels) {\n      copy[x + y * this.width] = color\n    }\n    return new Picture(this.width, this.height, copy)\n  }\n}\n\nexport function drawPicture(picture, canvas, scale) {\n  canvas.width = picture.width * scale\n  canvas.height = picture.height * scale\n  let ctx = canvas.getContext('2d')\n\n  for (let y = 0; y < picture.height; y++) {\n    for (let x = 0; x < picture.width; x++) {\n      ctx.fillStyle = picture.pixel(x, y)\n      ctx.fillRect(x * scale, y * scale, scale, scale)\n    }\n  }\n}\n","import { Picture } from './picture'\n\n/**\n * Update object state\n */\nexport function updateState(state, action) {\n  return { ...state, ...action }\n}\n\n/**\n * A less verbose DOM builder\n */\nexport function elt(type, props, ...children) {\n  let dom = document.createElement(type)\n  if (props) {\n    Object.assign(dom, props)\n  }\n  for (let child of children) {\n    if (typeof child !== 'string') {\n      dom.appendChild(child)\n    } else {\n      dom.appendChild(document.createTextNode(child))\n    }\n  }\n  return dom\n}\n\n/**\n * A hex helper function facilitate conversion of from 8 bit\n * numerical presentation of color to base-16.\n */\nexport function hex(n) {\n  return n.toString(16).padStart(2, '0')\n}\n\n/**\n * Cache data to local storage\n */\nexport function cached(data) {\n  localStorage.setItem('_state', JSON.stringify(data))\n  return data\n}\n\n/**\n * Get cached state from local storage\n */\nexport function getCachedState() {\n  let state = JSON.parse(localStorage.getItem('_state'))\n  if (!state) return\n  state.done = state.done.map(\n    ({ width, height, pixels }) => new Picture(width, height, pixels)\n  )\n  state.redone = state.redone.map(\n    ({ width, height, pixels }) => new Picture(width, height, pixels)\n  )\n  state.picture = new Picture(\n    state.picture.width,\n    state.picture.height,\n    state.picture.pixels\n  )\n  return state\n}\n","import { elt } from '../utils'\nimport { drawPicture } from '../picture'\n\nconst SCALE = 10\n\nexport class PictureCanvas {\n  constructor(picture, pointerDown) {\n    this.dom = elt('canvas', {\n      onmousedown: (event) => this.mouse(event, pointerDown),\n      ontouchstart: (event) => this.touch(event, pointerDown),\n    })\n    this.syncState(picture)\n  }\n\n  syncState(picture) {\n    if (this.picture == picture) return\n    this.picture = picture\n    drawPicture(this.picture, this.dom, SCALE)\n  }\n}\n\nPictureCanvas.prototype.mouse = function (downEvent, onDown) {\n  // return if not a left click\n  if (downEvent.button != 0) return\n  let pos = pointerPosition(downEvent, this.dom)\n  let onMove = onDown(pos)\n  if (!onMove) return\n\n  let move = (moveEvent) => {\n    if (moveEvent.buttons == 0) {\n      this.dom.removeEventListener('mousemove', move)\n    } else {\n      let newPos = pointerPosition(moveEvent, this.dom)\n      if (newPos.x == pos.x && newPos.y == pos.y) return\n      onMove(newPos)\n    }\n  }\n  this.dom.addEventListener('mousemove', move)\n}\n\nfunction pointerPosition(pos, domNode) {\n  let rect = domNode.getBoundingClientRect()\n  return {\n    x: Math.floor((pos.clientX - rect.left) / SCALE),\n    y: Math.floor((pos.clientY - rect.top) / SCALE),\n  }\n}\n\nPictureCanvas.prototype.touch = function (startEvent, onDown) {\n  let pos = pointerPosition(startEvent.touches[0], this.dom)\n  let onMove = onDown(pos)\n  startEvent.preventDefault()\n  if (!onMove) return\n\n  let move = (moveEvent) => {\n    let newPos = pointerPosition(moveEvent.touches[0], this.dom)\n    if (newPos.x == pos.x && newPos.y == pos.y) return\n    pos = newPos\n    onMove(newPos)\n  }\n  let end = () => {\n    this.dom.removeEventListener('touchmove', move)\n    this.dom.removeEventListener('touchend', move)\n  }\n  this.dom.addEventListener('touchmove', move)\n  this.dom.addEventListener('touchend', end)\n}\n","import { PictureCanvas } from './components/picture-canvas'\nimport { elt } from './utils'\n\nexport class PixelEditor {\n  constructor(state, config) {\n    let { tools, controls, dispatch } = config\n    this.state = state\n    this.canvas = new PictureCanvas(state.picture, (pos) => {\n      let selectedTool = tools[this.state.tool]\n      // call the selected tool util in ./src/tools.js\n      let drawFunction = selectedTool(pos, this.state, dispatch)\n      if (drawFunction) {\n        // call the function returned by the selected tool\n        return (pos) => drawFunction(pos, this.state)\n      }\n    })\n    this.controls = controls.map((Control) => new Control(state, config))\n    this.dom = elt(\n      'div',\n      {},\n      this.canvas.dom,\n      elt('br'),\n      ...this.controls.reduce((a, c) => a.concat(' ', c.dom), [])\n    )\n    document.addEventListener('keydown', (e) => {\n      e.preventDefault()\n      dispatch({\n        undo: (e.metaKey || e.ctrlKey) && e.code === 'KeyZ',\n        redo: (e.metaKey || e.ctrlKey) && e.code === 'KeyY',\n      })\n    })\n  }\n\n  syncState(state) {\n    this.state = state\n    this.canvas.syncState(state.picture)\n    for (let ctrl of this.controls) {\n      ctrl.syncState(state)\n    }\n  }\n}\n","/**\n * The draw tool\n */\nexport function draw(pos, state, dispatch) {\n  function drawPixel({ x, y }, state) {\n    let drawn = { x, y, color: state.color }\n    dispatch({ picture: state.picture.draw([drawn]) })\n  }\n  // immediate call to drawPixel and a return call of the same function\n  drawPixel(pos, state)\n  return drawPixel\n}\n\n/**\n * To draw larger shapes, it can be useful to quickly create rectangles.\n */\nexport function rectangle(start, state, dispatch) {\n  function drawRectangle(pos) {\n    let xStart = Math.min(start.x, pos.x)\n    let yStart = Math.min(start.y, pos.y)\n    let xEnd = Math.max(start.x, pos.x)\n    let yEnd = Math.max(start.y, pos.y)\n    let drawn = []\n    for (let y = yStart; y <= yEnd; y++) {\n      for (let x = xStart; x <= xEnd; x++) {\n        drawn.push({ x, y, color: state.color })\n      }\n    }\n    dispatch({ picture: state.picture.draw(drawn) })\n  }\n  drawRectangle(start)\n  return drawRectangle\n}\n\n/**\n * To quickly draw circles\n * assisted by chatGPT\n */\nexport function circle(start, state, dispatch) {\n  function drawCircle(pos) {\n    const radius = Math.sqrt(\n      // eslint-disable-next-line no-restricted-properties\n      Math.pow(pos.x - start.x, 2) + Math.pow(pos.y - start.y, 2)\n    )\n    const centerX = start.x + radius\n    const centerY = start.y + radius\n    let drawn = []\n    for (let y = centerY - radius; y <= centerY + radius; y++) {\n      for (let x = centerX - radius; x <= centerX + radius; x++) {\n        const distance = Math.sqrt(\n          // eslint-disable-next-line no-restricted-properties\n          Math.pow(x - centerX, 2) + Math.pow(y - centerY, 2)\n        )\n        if (distance <= radius) {\n          drawn.push({ x, y, color: state.color })\n        }\n      }\n    }\n    dispatch({ picture: state.picture.draw(drawn) })\n  }\n  drawCircle(start)\n  return drawCircle\n}\n\n/**\n * This function uses the Bresenham's line algorithm to draw a triangle\n * on the canvas\n * assisted by chatGPT\n */\nexport function triangle(start, state, dispatch) {\n  function drawTriangle(pos) {\n    const x1 = start.x\n    const y1 = start.y\n    const x2 = pos.x\n    const y2 = pos.y\n    const deltaX = Math.abs(x2 - x1)\n    const deltaY = Math.abs(y2 - y1)\n    const signX = x1 < x2 ? 1 : -1\n    const signY = y1 < y2 ? 1 : -1\n    let x = x1\n    let y = y1\n    let error = deltaX - deltaY\n    let drawn = []\n\n    while (x !== x2 || y !== y2) {\n      drawn.push({ x, y, color: state.color })\n      const error2 = 2 * error\n      if (error2 > -deltaY) {\n        error -= deltaY\n        x += signX\n      }\n      if (error2 < deltaX) {\n        error += deltaX\n        y += signY\n      }\n    }\n    drawn.push({ x: x2, y: y2, color: state.color })\n\n    dispatch({ picture: state.picture.draw(drawn) })\n  }\n\n  drawTriangle(start)\n  return drawTriangle\n}\n\nconst around = [\n  { dx: -1, dy: 0 },\n  { dx: 1, dy: 0 },\n  { dx: 0, dy: -1 },\n  { dx: 0, dy: 1 },\n]\n\n/**\n * Flood fill tool.\n */\nexport function fill({ x, y }, state, dispatch) {\n  let targetColor = state.picture.pixel(x, y)\n  let drawn = [{ x, y, color: state.color }]\n  for (let done = 0; done < drawn.length; done++) {\n    for (let { dx, dy } of around) {\n      // eslint-disable-next-line one-var\n      let x = drawn[done].x + dx,\n        y = drawn[done].y + dy\n      if (\n        x >= 0 &&\n        x < state.picture.width &&\n        y >= 0 &&\n        y < state.picture.height &&\n        state.picture.pixel(x, y) == targetColor &&\n        !drawn.some((p) => p.x == x && p.y == y)\n      ) {\n        drawn.push({ x, y, color: state.color })\n      }\n    }\n  }\n  dispatch({ picture: state.picture.draw(drawn) })\n}\n\n/**\n * Color picker tool\n */\nexport function pick(pos, state, dispatch) {\n  dispatch({ color: state.picture.pixel(pos.x, pos.y) })\n}\n","import { elt, hex } from '../utils'\nimport { Picture } from '../picture'\n\nexport class LoadButton {\n  constructor(_, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => startLoad(dispatch),\n      },\n      '📁 Load'\n    )\n  }\n\n  syncState() {\n    // unimplemented\n  }\n}\n\n/**\n * Gets the file from the user's computer through use of an `<input>` HTML element with the `file` attribute\n * @param {*} dispatch\n */\nfunction startLoad(dispatch) {\n  let input = elt('input', {\n    type: 'file',\n    onchange: () => finishLoad(input.files[0], dispatch),\n  })\n  document.body.appendChild(input)\n  input.click()\n  input.remove()\n}\n\n/**\n * When the user has selected a file, we use the `FileReader` to\n * get access to its contents, again as a data URL.\n * This URL can be used to create a `<img>` element; since we can't\n * get direct access to the pixels in such an image, we can't create\n * a `Picture` object from that. A call to `pictureFromImage` handles this conversion.\n * @param {*} file\n * @param {*} dispatch\n */\nfunction finishLoad(file, dispatch) {\n  if (file == null) return\n  let reader = new FileReader()\n  reader.addEventListener('load', () => {\n    let image = elt('img', {\n      onload: () =>\n        dispatch({\n          picture: pictureFromImage(image),\n        }),\n      src: reader.result,\n    })\n  })\n  reader.readAsDataURL(file)\n}\n\nfunction pictureFromImage(image) {\n  let width = Math.min(100, image.width)\n  let height = Math.min(100, image.height)\n  let canvas = elt('canvas', { width, height })\n  let ctx = canvas.getContext('2d')\n  ctx.drawImage(image, 0, 0)\n  let pixels = []\n  // this data property is an array of color components\n  // contains 4 values which represent reg, green, blue and alpha (for transparency) of the pixel's color as 8 bit numbers (0-255)\n  let { data } = ctx.getImageData(0, 0, width, height)\n\n  for (let i = 0; i < data.length; i += 4) {\n    let [r, g, b] = data.slice(i, i + 3)\n    pixels.push(`#${hex(r)}${hex(g)}${hex(b)}`)\n  }\n  return new Picture(width, height, pixels)\n}\n","import { elt } from '../utils'\nimport { drawPicture } from '../picture'\n\nexport class SaveButton {\n  constructor(state) {\n    this.picture = state.picture\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => this.save(),\n      },\n      '💾 Save'\n    )\n  }\n\n  save() {\n    let canvas = elt('canvas')\n    drawPicture(this.picture, canvas, 10)\n    let link = elt('a', {\n      href: canvas.toDataURL(),\n      download: 'pixel-art.png',\n    })\n    document.body.appendChild(link)\n    link.click()\n    link.remove()\n  }\n\n  syncState(state) {\n    this.picture = state.picture\n  }\n}\n","import { elt } from '../utils'\n\nexport class UndoButton {\n  constructor(state, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => dispatch({ undo: true }),\n        disabled: state.done.length < 2,\n      },\n      '⤴ Undo'\n    )\n  }\n\n  syncState(state) {\n    this.dom.disabled = state.done.length < 2\n  }\n}\n","import { elt } from '../utils'\n\nexport class RedoButton {\n  constructor(state, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => dispatch({ redo: true }),\n        disabled: state.redone.length < 1,\n      },\n      '⤵ Redo'\n    )\n  }\n\n  syncState(state) {\n    this.dom.disabled = state.redone.length < 1\n  }\n}\n","import { elt } from '../utils'\n\nexport class ResetButton {\n  constructor(state, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => {\n          // eslint-disable-next-line no-restricted-globals, no-alert\n          if (confirm('Are you sure you want to reset the canvas?')) {\n            dispatch({ reset: true })\n          }\n        },\n        disabled: !state.done.length,\n      },\n      '🔁 Reset'\n    )\n  }\n\n  syncState(state) {\n    this.dom.disabled = !state.done.length\n  }\n}\n","import { elt } from '../utils'\n\nexport class ToolSelect {\n  constructor(state, { tools, dispatch }) {\n    this.select = elt(\n      'select',\n      {\n        onchange: () => dispatch({ tool: this.select.value }),\n      },\n      ...Object.keys(tools).map((name) =>\n        elt(\n          'option',\n          {\n            selected: name == state.tool,\n          },\n          name\n        )\n      )\n    )\n    this.dom = elt('label', null, 'Tool: ', this.select)\n  }\n\n  /**\n   * Sync ToolSelect state\n   * @param {*} state\n   */\n  syncState(state) {\n    this.select.value = state.tool\n  }\n}\n","import { elt } from '../utils'\n\nexport class ColorSelect {\n  constructor(state, { dispatch }) {\n    this.input = elt('input', {\n      type: 'color',\n      value: state.color,\n      onchange: () => dispatch({ color: this.input.value }),\n    })\n    this.dom = elt('label', null, '🎨 Color: ', this.input)\n  }\n\n  /**\n   * Sync the ColorSelect state\n   * @param {*} state\n   */\n  syncState(state) {\n    this.input.value = state.color\n  }\n}\n","import { LoadButton } from './load-button'\nimport { PictureCanvas } from './picture-canvas'\nimport { SaveButton } from './save-button'\nimport { UndoButton } from './undo-button'\nimport { RedoButton } from './redo-button'\nimport { ResetButton } from './reset-button'\nimport { ToolSelect } from './tool-select'\nimport { ColorSelect } from './color-select'\n\nexport {\n  LoadButton,\n  PictureCanvas,\n  SaveButton,\n  UndoButton,\n  RedoButton,\n  ResetButton,\n  ToolSelect,\n  ColorSelect,\n}\n","import { PixelEditor } from './app'\nimport { draw, fill, pick, rectangle, circle, triangle } from './tools'\nimport {\n  LoadButton,\n  SaveButton,\n  UndoButton,\n  RedoButton,\n  ResetButton,\n  ToolSelect,\n  ColorSelect,\n} from './components'\nimport { Picture } from './picture'\nimport { cached, getCachedState } from './utils'\n\nconst INITIAL_STATE = {\n  tool: 'draw',\n  color: '#000000',\n  picture: Picture.empty(60, 30, '#f0f0f0'),\n  done: [],\n  redone: [],\n  doneAt: 0,\n}\n\nconst baseTools = {\n  draw,\n  fill,\n  pick,\n  rectangle,\n  circle,\n  triangle,\n}\n\nconst baseControls = [\n  ToolSelect,\n  ColorSelect,\n  SaveButton,\n  LoadButton,\n  UndoButton,\n  RedoButton,\n  ResetButton,\n]\n\n// quasi - reducer function\nfunction historyUpdateState(state, action) {\n  if (action.undo) {\n    if (state.done.length < 2) return state\n    let redone = state.done.pop()\n    return cached({\n      ...state,\n      picture: state.done[state.done.length - 1],\n      done: [...state.done],\n      redone: [...state.redone, redone],\n      doneAt: 0,\n    })\n  }\n\n  if (action.redo) {\n    if (state.redone.length < 1) return state\n    let picture = state.redone.pop()\n    return cached({\n      ...state,\n      picture,\n      done: [...state.done, picture],\n      redone: [...state.redone],\n      doneAt: 0,\n    })\n  }\n\n  if (action.reset) {\n    let picture = Picture.empty(60, 30, '#f0f0f0')\n    return cached({\n      ...state,\n      picture,\n      done: [],\n      redone: [],\n    })\n  }\n\n  if (action.picture && state.doneAt < Date.now() - 1000) {\n    return cached({\n      ...state,\n      ...action,\n      done: [...state.done, state.picture],\n      // redone state only relevant on undo, otherwise it remains empty\n      // on regular picture action\n      redone: [],\n      doneAt: Date.now(),\n    })\n  }\n  return cached({ ...state, ...action })\n}\n\nfunction startPixelEditor({\n  state = getCachedState() ?? INITIAL_STATE,\n  tools = baseTools,\n  controls = baseControls,\n}) {\n  const app = new PixelEditor(state, {\n    tools,\n    controls,\n    dispatch(action) {\n      state = historyUpdateState(state, action)\n      app.syncState(state)\n    },\n  })\n  return app.dom\n}\n\ndocument.getElementById('root').appendChild(startPixelEditor({}))\n"]}