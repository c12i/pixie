{"version":3,"sources":["picture.js","utils.js","components/picture-canvas.js","app.js","tools.js","components/load-button.js","components/save-button.js","components/undo-button.js","components/redo-button.js","components/reset-button.js","components/tool-select.js","components/color-select.js","components/index.js","index.js"],"names":["Picture","width","height","pixels","x","y","copy","slice","color","Array","fill","elt","type","props","dom","document","createElement","Object","assign","children","child","appendChild","createTextNode","drawPicture","picture","canvas","scale","ctx","getContext","fillStyle","pixel","fillRect","hex","n","toString","padStart","cached","data","localStorage","setItem","JSON","stringify","getCachedState","state","parse","getItem","done","map","redone","SCALE","PictureCanvas","pointerDown","onmousedown","event","mouse","ontouchstart","touch","syncState","downEvent","onDown","button","pos","pointerPosition","onMove","move","moveEvent","buttons","removeEventListener","newPos","addEventListener","startEvent","touches","preventDefault","end","domNode","rect","getBoundingClientRect","Math","floor","clientX","left","clientY","top","PixelEditor","config","tools","controls","dispatch","selectedTool","tool","drawFunction","Control","reduce","a","c","concat","onKeyDown","e","undo","metaKey","ctrlKey","code","redo","save","window","ctrl","draw","drawPixel","drawn","rectangle","start","drawRectangle","xStart","min","yStart","xEnd","max","yEnd","push","circle","drawCircle","radius","sqrt","pow","centerX","centerY","distance","triangle","drawTriangle","x1","y1","x2","y2","deltaX","abs","deltaY","signX","signY","error","error2","around","dx","dy","targetColor","length","some","p","pick","LoadButton","_","onclick","startLoad","input","onchange","finishLoad","files","body","click","remove","file","reader","FileReader","image","onload","pictureFromImage","src","result","readAsDataURL","drawImage","getImageData","i","r","g","b","SaveButton","link","href","toDataURL","download","prompt","UndoButton","disabled","RedoButton","ResetButton","confirm","reset","ToolSelect","select","value","keys","name","selected","ColorSelect","INITIAL_STATE","empty","doneAt","baseTools","baseControls","historyUpdateState","action","pop","Date","now","startPixelEditor","app","getElementById"],"mappings":";;AaAA;;AACA;;AACA;AVFA,AQAA,ANAA,AHAA,AMAA,ACAA,AHAA,AIAA,AHAA;AMWA;AVVA,AEAA,ACAA;AOWA;AZZA;;AAEA;AACA;ACDO,ADEP,IUFagM,ATAA/I,AMAAqI,ACAAC,AFAAH,KLAK,GAAG,EAAd;ASCL,AHAA,ACAA,AFAA,ANEK,SAASzK,GAAT,CAAaC,IAAb,EAAmBC,GOFZ8B,ADAAA,CIAAA,AFAAA,CREP,EAAuC,COF5C,ADAA,CIAA,AFAA,ODAiC,ADAA,CIAA,AFAA;AEAA,AHAA,ACAA,AFAA,ANGjC,IKHWmI,ELGPhK,EOHiByE,ACAAA,AFAAA,CNGd,GAAGxE,IOHuB,ACAA,AFAA,INGf,CAACC,GOHEuE,ACAAA,AFAAA,QCAY,ACAA,AFAA,ENGvB,CAAuB3E,IAAvB,CAAV;AKFA,AFJF,IFIasC,kBIACP,KAAZ,QAAiC;AKDA,ATEjC,AMFiC,ACAA,AHCA,ACDA,APHnC,AICA,AHME,MAAI9B,EUJiB0E,ALCAA,GLGrB,EAAW,GUJsB,ALCA,QKDZA,ALCAA,CJCT/D,OSFqB,ATEjC,AIDiC,EJCZ2B,WAArB,EAAkC;AAAA,AFJpC,AICA,AHMIlC,IAAAA,MAAM,CAACC,MAAP,CAAcJ,GAAd,EAAmBD,KAAnB;AUL+B,AHC/B,ACAA,AHA+B,ACA/B,APFJ,AICO,AHMJ,SOLMC,ACAAA,AFAAA,AHDO4F,GICZ,ACAA,AFAA,CHDG,CAAc7C,CICN,ACAA,AFAA,EHDR,EAAmBlB,KAAnB,EAA0B4C,KIE3B,ACAA,AFAA,GHFC,EAAoC,GIC5B,ACAA,AFAA,ECET,ACAA,AFAA;ALD8B,AME5B+D,ACAAA,AFAAA,AHHN,IJDWtJ,EQILsJ,ACAAA,AFAAA,KHHG3C,EIGI,ACAA,AFAA,ECAE,ACAA,AFAA,KHHf,OAA6BhE,KAA7B,EKGqB,ALHe;AOAlC,AHGa,ACCP,AHHN,ACEa,APHf,AIAoC,AHCQ,QGDvBvC,COAdoJ,ALCAhI,AFD6B,KOAlC,CHGmB+D,ADAAA,CDFnB,CKDa,APAMnF,CAAe,CECnBuC,ANDL1C,IQGiB,ADAA,CCAC,AFFR,ACEQ,APH9B,CMCuBuB,CNDJtB,MMCjB,ANDF,CWAmB,CXAQC,ECCOgB,IUDnB,AXAf,EWA4B,AXAO,ECCS;AUAxCP,ATCF,AMC8B0F,ACExB,AHHN,ACC8BJ,APHG,AIAC,AHCF/E,IAAAA,EUA9BP,EPDoBP,CFEjBS,AIAAA,AFF6B,COC5B,AHEwBwF,ADAAJ,EIFtB,ATCR,AOGUsF,AHHV,ALD0C,EOER,ADAA,CLDvB,AIAA,CECyB,ADAA,CHHdnL,CAAY,COAR,AFKT,CAAC,WPHH,AICb,QJDS,AIAA,EJAc,AIEvB,uBGCe,CAAX,EAA2D;AEH/DuL,ATCAxI,AMA0B,ACGpBmC,AHDJ+D,ACFwB,AHF5B,AHA0C,MUCxCsC,ATCAxI,AIEEkG,EFJA1C,CIEuB,ADAA,CCAd,ACGLrB,AFHK,CIDN,EAAE5C,ALGE,AFJF,EEII,CFJD,CFEC,CSDC,AFIE,CEJDnC,ATCA,AOGE,KENS,gBTGV6C,KAAD;ASAboG,ATAa,AMAF,ACGMgC,AHDN,ACFA,APFb,AIAcrL,MOEZqJ,APFYrJ,CICZ,ADAA,AHDa,EJAVH,AIASG,CAAF,EKKOqL,EEHT,AXFV,CEE0B,AIEPlG,CKFP,CFGY,ATLXtF,ESKa,CPHI,CAACqD,CFF/B,CMI2B,CAAC,EJFF,CAAWD,KAAX,EAAkBF,WAAlB,CAAX;ASAH,ATAG,AMCXkI,ACEa,AHDa9E,ACD1B8E,APFJ,AIDiBhL,AHKnB,ISRWqL,EFMLL,ADAAA,AHHahL,CFCQ,AEDP,EJCbH,AIDYG,CEIakG,AFJlB,CKKI,CAAR,EDFI,AFCsB,ACDtB,CIDMhB,AXDlB,CQEc5C,AFCsB,ACDtBA,EPFAzC,GQEK,ADAA,CCAC8C,ADAAF,CIDM,CAAC,AXD3B,EOEc,CAAWkG,CCAX,CAAaA,EPEX7H,EMFF,ECAA,CDAoB,ECAE,CPEtC,+BAA4B;AUHGX,ATC3B+C,AMFA,ACKK,AHFqB,AIN9B,AHGI,APCF,AIFoB/C,AHKjB,KONQ,ADAA,CLIT+C,AEHkB/C,CIKlB,ADAA,CNAKY,CKDoB,ANFtBjB,CWAwBK,ALEhB,CFJY,EAAEmC,AHKf,EUHsB,AHHvB,ADAA,APGX,CQHA,ADAA,CIGoC,CTCtB,AFDAxC,AIFkB,CAACK,CFGjB,ESDwB,ADJ9BmC,CCI+B6G,CXAzC,GUJF,CCIsC,CAAWoC,AVG5C,MSPmC,ORKrBvI,KAAD;ASDW,ATCX,AMIjB,ACAM,AHHQ,AINyB,AHSvC,APJA,AIHa,ICFH+F,CDET,EKCE,EECwB,CAAd,KTCe,KAAI,CAAC5F,KAAL,CAAWH,KAAX,EAAkBF,WAAlB,CAAX;ASDJ,ANHd,AHIkB,AOKZkI,AHLF,AOMN,ATRI9F,AHKA,IYGE0G,ATRF1G,CEAW,CGOP8F,CHFF,CLAE,IGLI,CAAC,CKOG,CRFDjK,CQEG,AHPH,CGOIuB,AHPf,AOQe,GAAG,AZHd,EIPM0G,AISU,CJTtB,AISuBvG,ERFA,EQEN,CAAWkG,GJTC,EJO3B,EAA+B;AUPL,ANAC,AHEF,AOAvB,AHOH,AIVuC,AGYxCvD,ATTajE,AHMTV,EYGJ2E,EVZWN,CQCI,ATEF,AOFA,CEAX,ATEA,AWSE,ATTS3D,AHMTV,CQGA,CJXayE,AKDIF,AGYf,CZHC,CAAChE,GSTgC,ANGpB,CSQA,CTREsB,CCFO,CIAhB,CAAX,ELEyB,CMHN0C,ANGO7D,AHMxB,CAAgBJ,EIRHmE,EKDuB,CTSpC,CGNkB,CAAcmB,GCFP,CDEP,CAAmB,CAACE,KAAD,CAAnB;ADFtB,AQKE,ATCA,AOOD,ACduC,AGaxCpG,ATVW,AHOR,EYGHA,GTVU,AHKR,CGLA,CSUG,CHbuB+E,CCMrBzE,ATCA2C,AWMA,EZHE,CUJP,GAAW,CDN2B,EROtC,AWIkB,CXJHjC,ICNLmB,CODgB4C,ERO1B,ECNF,EAAmBH,CQKF,CDNuB,IPCxC,EAA2B,AQKd,EAAa,IAAb,EAAmB,YAAnB,EAAiC,KAAKoE,KAAtC,CAAX;ARLyB,AQM1B,ANN4B,AHO5B,AWMDhI,ATVC,AHOGV,EYGJU,CTdyC,CAKzC,EHMIV,GYGG,AZHA,CAACO,COAR,ADAA,AMGSrB,AbFT,UCDI,CAAgBe,IDCdX,CAAN,EaEiB8L,AbFR7L,CQDCsC,ADAAA,APCV,ACD4B,CAACrB,CDCjB,EaEH,CLHT,ADAA,AMGuB,ELHN,ADAA,AMGR,EAAkB,EAAlB,EAAsB,EZHX,CAAwBF,KAAxB,CYGX,AZHL,CYAgB;AFFpB,AHGE,AEZsC,AHYtC,AMGF0B,AbFE,ACDC,EYGHA,IAAI,EAAE,EAJc,CLCbhC,ADAAA,EPCE,CQDP,ADAA,CCASuK,ADAAA,GPCGlL,KQDZ,ADAA,CPCO,CAAYC,CQDCuC,ADAAA,APCA,GAAGtC,CAAC,CQDC,ADAA,CCAC2C,ADAAF,CPCC,GODP,CAAWkG,CCAX,ARCY/I,CQDC+I,IDAb,APCb,CAAP,CQDoB,CDAoB,CAAxC,CCA0C,CAA1C;ALXyB,AQS7B,ANRI,AGWD,ADAA,AMGDhG,AbFC,ACDA,EYGDA,MAAM,CRdClC,CQcC,CPSR,CDvBE,AQSkB,GRTP,eCuBH6B,CDtBN,ICsBJ,EAAiB,EDvBJ,EAET;AMON,ANNQ2G,ACqBJ,AIzBA,AGgBF6C,ATXAxF,ESWAwF,ATXAxF,ICDM2C,EQYA,CHhBCqC,CGgBC,CJDR,AHUOnK,AFpBE,CAACqC,CCDG,EAAE,AKJb,ANKO,EAAMlB,CEoBb,AIzBchC,GJyBCgC,CFpBR,CAAT,GEoBsB,CAACnB,GGVbmB,IHUR,CGVF,EAAiB,OCdb,QADY,EAEZ;APDF,AQUJ,ANPiB,AIYb,AHUD,AIvBK8G,AGOc,ATJpB,AHOA,CYHF,KHPQA,EPFEpE,CCKDsB,AHOA7F,ECJP,AOOOA,CRHP,CEZE,CMeA,ACbY,CLCOyI,AIYV8B,CNf2BjG,AOEtB,ENGhB,IDLE,CAAMC,AMeN,CJZ4B,CAACE,CIYT,CAAC5C,CNfrB,EDQQnB,EOOkB,CJZE,AIYDsB,CJZd,GHKf,AOOuB,CAAWkG,CPPf,KOOjB;ANfA,AEGa,AHMb,AOOD,ACde,AGgBlB,ATZC,AHOA,IYKKoD,IVlBW9G,EDST,CFKN,EaIa,EXTF9D,AQPW+D,CPFpB,AUkBc,GVlBsBH,GDShC,CQPwB,CAAC,CPF7B,AHcGjF,CGdUmF,ADSO9D,KFKtB,EELE,AFKW,CGdX,CDS6B;ACT7B,AEEE,AHQF,AQR+BiE,AGiBjCiB,AbJE,AIPJ,AHOA,EYIEA,GRnBa,CQmBT,CRdA,CFLqBnB,AUmBzBmB,EHjBiCjB,AVa3BnF,CELCkB,GQR8B,AVa3B,EGfR,AEAW,AKE0B,CLFrC,ALeW,CELX,CCVoC4D,AUkBtB,EXRC5D,AQR0B,CAACmK,AVa1BxL,GGfhB,CAAuBoF,EDUvB,AQRqC,AVa1B,CUbsCqG,AVa1BrL,KGfvB,AHeW,EAAX;AGdA,AEMD,AHIC,AQT6B,AGkB/BG,ATXF,AHOA,EYIEA,IAAI,EAAJA,CVnBOiC,AOCuB,CAAd,CJQhB,GHTE,GAAaA,EUiBC,GVjBd,GGSUnB,KJCE,EIDd,EAAqB,CJCFA,OAAjB,EAA0B,KAAKV,GAA/B,EAAoCmC,KAApC;ACTA,ADUD,AIFoB,AIRL,AGmBhBkG,AbPa,AIJf,AHOA,EYIEA,IAAI,EAAJA,CVnBO1H,MAAL,GAAc,CUgBA,GVhBIyB,2BHcU/C,CGdd,CAAkBwC,IHYrB,CGZ0B,CAACnB,OAAxB,EAAiC,UAACqC,GAAD,EAAS;AACtD,AOFA,AGqBJgD,AbRa,EaQbA,GHvBgB,KPIRrB,CQQR,AEWS,EAATqB,SVnBoB,GAAGxB,IUeP,CVfY,AQQlB1C,CRRmB,EOCtB1B,ECOP,CRRiC,CAAC0B,AQQjB,EDPJ,CAACkJ,EPDe,CAAWpG,COCjC,CAAYJ,EPDS,CAAxB,CADsD,CAEtD,AOAG,EAAmBtC,GAAnB,CAAuB,UAAC+I,IAAD;ACQ5B,ALDA,AIP4B,AGmB9BvE,EAAAA,MAAM,EPZA9F,AOYN8F,CFXOiC,EDPD,GCOJ,ALDU,CKCCoC,ELDE,GKCb,CEMc,EFNKjJ,IDNb,CCMkB,CAACnC,ILDR,CKCjB,CDPI,EAEE,IJIO,CAAb;AHNE,AQQH,ALDC,AIJQuL,AGgBVhE,AbVa,AIHR,AHOA,EYMLA,MHhBUgE,CNGIlF,AHOAtF,CEbNmE,AUmBA,CRfR,AHKA,CWUAqC,IHhBkB,EAAE+D,ANGf,CAAmBhF,CHOnB,CAAqBtF,CEbN,AOGI,ENGnB,CDNkBgE,CDSjB9B,AQNsBf,ANGGA,EHO1B,EKNSnB,ALMqBC,CSVF,ANG5B,CCFO,AKDsBgE,CLEhC,ADCoCF,EFGtC,CDIK,CEb8B,ADSlB5B,AIFf,CHPkCE,AFaOnC,CKNpBD,EHPY,ACM9B,EDNoC,ADSzC,AEHgD,AHO3C,ECJoB,AIFvB,ALMgD,EKNnBwB,CHPc,CAACN,KAAX,EAAkB4C,QAAlB,CAA/B,EGOF;ADDD,AHGwB,AIDvB,AINM,AGWQ,AbFd,AIJF,AHOA9D,CYDF,CZCEA,KSdM,CTcA,CSTEqK,ATSD7L,CKND8K,CFDGhE,EMPH,CJQI,AIToB,ATe9B,GKNa,ALMEvF,OGPf,AHOsB,CGPCqC,AHOA5D,GGPvB,EAA4B,AHOb,GKNE,ALMcyB,GKNlB,EAAS,ALMtB,sBDHsC;AGVlC,AGQAsJ,AIV0B,AGuBhC,AbXwC,AIHpC,AHOFvJ,EAAAA,EYOI4K,CHvBG,CALS,EJeZrB,AFDEhE,AHOA,CSrBJ,ATqBK9G,CEdCwF,EGQA,EAAEjE,AFDE,CHOZ,CYOgB,CTdDoD,CHOCrD,CYOG,CPbH,AOchBkK,CPdiBT,AFDE,CDPf,ACOgBhE,EDPE,CCOP,AHOQ,CGPCH,AHOA5G,IKNd,CFDmB,CEAP,AFAQE,AHOd,CGPD,EAAkByD,AHOAnC,GGPG,CAACtB,CAAtB,AHOf,CGPE,CSciB,EAEnB4L,uBAFmB,EAGnBlB,sBAHmB,EAInB1B,sBAJmB,EAKnBgC,sBALmB,EAMnBE,sBANmB,EAOnBC,uBAPmB,CAArB,EAUA;AV9BQ,ADQJ,AIAE,AIDF,AVEoC,AIFpC,AHOF,MAAI5J,EGPEuF,CMACpG,ATOA,GSPL,ATOQW,EDLGrB,AIFD,CMAC,AVEyB,EIFvByE,CHOC,CAACjD,EGPE,CAACqF,GAAL,CAASH,GHOd,CDLG1G,ACKe,CSPX,AVEqB,AIFT,CAACC,CAAf,CHOL,CGPuBwD,AHOjC,GSPa,ANAuB,CAACxD,CMAX,ANAX,CAAb,GMAW,EAAmB,QAAnB,EAA6B,KAAKsL,MAAlC,CAAX;APNI,ADQJ,AIAET,AIDH,AGuBH,AbtBwC,AIDpC,QECEA,AFDE/D,CSuBCmF,CXtBD5I,EEDI,EJCMrD,CGRH,AHQyB,AIDzBwE,CECD,GJAG,AEDE,CFCDjB,AEDEwD,GAAL,CAASN,CDPRjD,CDQR,CWsBR,CV9Be,AU8BalB,CTvBC,CFCD,AFAVtC,AIDYD,CFC1B,AFAoC,AIDzB,EFCgB,AWsB/B,ATvBiCyD,ESuBE0I,CTvBC,CAACnM,CAAtB,CECI+K,AFDf,ESuBJ,EAA2C,EPtBlB,CAAC,eAAD,EAAkB,WAAlB,CAAX,6CAA6C,WAA7C;AHRC,ADSX,AIJoB,AIItB,AGsBA,AbvBsC,AIApC,AHOF,MYgBIoB,CP1BS,ALUR,CKVH,AFGIlF,EFCAxD,CDMGxD,CYgBC,ATvBA,AHOA,CCND,AWsBE6F,CbvBQ1F,CIANqE,AHOA,CCNDf,ADMZ,CEfsB4B,AU+BtB,CZhBgBrF,CYgBC,AbvBqB,AIArB,AHOA,CGPC+G,EHOE5F,CGPP,CAASsF,KDRY,ACQP,AHOA,CEfQjD,ACQPxD,AHOAH,CCND,AEDd,CFCewD,CCTM,ACQHG,CJAZrD,CGRqB,CCQN,AHOlC,CGPmCH,CAAtB,AHOuBA,CDPE,AIApC,AHOmC,CEfO,CAACsC,ADSlB,ADM3B,ECNuC,ADME,GEfP,CAArB,CDS+B7B,GAAjB,CAAzB;ACTW,AEMf,AHII,AIAAC,AIAJ,AGsBI,AbvBET,AIAF,AHOA,MKNAS,EOsBI4B,ATvBAiE,CDTA,AFgBC,CCND7C,AFDFzD,GauBO,ATvBA,AHOAF,CKND,AOsBE0C,AbvBJ,ACOI,CKND8G,ANDFxJ,CECG,AFDF,AIAI,CHOC,CYgBT,ATvBJ,AHOA,CCNauD,AIAb,AOsBeqF,AbvBJ3I,CMCGgB,ANDF,ACOIjB,CAAC,EDPF,CCOKoB,CCND,AWsBf,CXtBgBqC,EWsBI,AbvBJ5D,CECD,AWsBnB,CXtBA,CIAA,AOsB2B,AZhBA,CKND8K,ALME9K,CDPtB,CAAJ,EMCF,CND6BO,ACO7B,CYgBkCmC,CZhBCvC,CAAC,EDPlC,ACOF,CYgB2B,CZhBa;AEfrC,AEMP,AHII,AIAA2K,AIAJ,AGsBI,AbvBC,ACOCpJ,MKNFoJ,ALMEpJ,EYgBEqB,CZhBC,CCND,AIAA,ALMEnB,CCNDkC,AIAA8F,GOsBK,EPtBV,CJAA,AWsBalH,EXtBA,ADMX,GYgBgB,AZhBAnB,CYgBCsB,IAAN,CAAW0J,CZhBC,CAAC1K,CYgBb,EAAb,EZhBkB,CAAc1B,CAAd,EAAiBC,CAAjB,CAAhB;AEfD,AEML,ACII0K,AIAJ,AGsBI,Ab5BW,AIIX,AHQEpJ,KExBY,CAAd,AGkBAoJ,ALMEpJ,GGRG,AHQA,CKND,ALMEI,CKND+H,AOsBE,ETxBEzJ,CAAC,GEEV,AFFa6G,CHQX,CAAa9G,CAAC,GGRhB,AHQmBsB,EGRErB,CAAC,EHQpB,EGRwBgH,AHQAhH,CAAC,GGR3B,AHQ8BqB,EGRErB,CAAC,EAAjC,AHQE,EGRmC,AHQAqB,KAAnC,EAA0CA,KAA1C,SYiBGiB,KADE;AV/BP,AEMJ,AHII,AIAD,AOuBGnB,Ab9BS,AIKT,AHQD,MYiBCA,GVjCG8D,CDUDtB,CEFG,ESyBE,CXvBD,CWuBGrB,ATzBAvC,CAAC,CDRZ,ADUW,EEFI4G,CDRC1B,AUiCA,CAACxC,IAAN,ATzBT,CFEEkB,AWuBkBrB,CTzBCvC,CDRC,ACQA,CDRC2C,CDUd,CAACkB,AWuBe,CVjCX,AUiCYnB,ATzBAqE,CDRC,GUiCP,ATzBpB,CSyB+B6B,CTzBC5I,CAAC,CFExB,CEFT,CFEwB,CCVIuF,AUiCR,ATzBiB,GSyBG,CAA/B,CAFJ,EV/BsB;AAAA,AShBjC,AV2BM,AWuBA7C,Ab/BS,AIMP8D,AHQL,MYiBG9D,ETzBE8D,ESyBE,EXvBA3C,CCXoC,ACSjC,CAACqD,GDToC3B,CCS1C,CAAW,EFEA,CAACzB,ECX0B,CAAYvB,IDWhD,CCXoC,CUkC9BA,CVlCiDyC,CDWlC,CAAzB,EAA4B,AWuBb,CAACtC,CVlCwB,CAAb,EUkCvB,CAHC;AV/BsB,ADYzB,AWuBFE,AbhCS,AIMM5C,AHSpB,KElBmB,CAAhB,AUmCE4C,IXvBE,AEHa5C,CAAC,CS0BV,CT1BSA,CAAF,EFGP,CAACU,GAAL,CAASqD,mBAAT,CAA6B,EWuBnBxB,KAAK,CAACK,GXvBhB,EAA0CgB,CWuBtC,GXvBJ,CWuBwBhB,MAApB,EAJD;AV9BP,AShBJ,AV4BO,AWuBDmJ,AbjCS,AIMS9L,AHWxB,MYgBM8L,GVnCGrL,ADUH,CEFkBT,CAAC,CDRrB,AUmCQ,CT3BYA,CS2BV,AT3BK,CDRJM,ADYF,0BCXP,KADS,EAET,EAFS,EAGT,KAAKc,MAAL,CAAYX,GAHH,EAIT,gBAAI,IAAJ,CAJS,4BAKN,KAAKwE,QAAL,CAAcM,MAAd,CAAqB,UAACC,CAAD,EAAIC,CAAJ;AAAA,ADQtB,AWiBG,ATtBgBtF,AHY3B,OYUI,GTtBuBA,CMCzB,EPJsCqF,CAAC,ADQ7BzB,CCR8B2B,ACGV,EAAEpD,GFKhB,CCRsB,CAAS,ACGV,CFKlBmB,AELmBtD,EDHA,EAAcsF,CAAC,CAAChF,COI5C6B,EPJ4B,CAAV,EOI5B,EAAiB,CRIiB,CAACsB,SAAD,EAAY,MAAI,CAACnD,GAAjB,CAA5B;ACRsB,ASpB9B,APqBA,AHQQ,AQJJ,AG2BD,Ab9BC,AICe,AHanB,KEhBS,EAAqD,EAArD,AECAyI,ADED,CDRO,COUNoC,EPVL,AHOO,CEOCvH,GQJR,AVHWpE,CKDf,AKIgB4L,CLJGrG,CHQD,CAACnF,CAAP,CQJR,CVHO,CAAY,CEOCyD,AQJAlB,CLJxB,EAA6B,AHQF,CAACvC,AFPAH,CEOhB,AQJiB,CAACwF,GRIGrB,AFPtB,CUGP,CVH+B,IEOI,CAAC/D,AFPAH,CEOP,IAAY2D,CFPlC,EEOqC,AFPAvD,CEOCD,CAAzC,EAA4C,AFPzC,CAAP;AKAF,AHQM0D,AQJL,AVHA,AICI,AHaP,MIfMyF,IHQEzF,CGRG,GAAG,EHQA,CAACK,MAAD,CAAN,MGRU,OAAJ,EAAa;AFAvB,ASrBJ,APsBIxD,AHQG,AWuBL,AT7BG,ICFDA,EQ+BE2L,EVhCIvG,AECF,EAAE,EQ+BE,CAACM,GRhCc,CFAR,AUgCjB,EAAiB,CVhCG,SAAZN,SAAY,CAACC,CAAD,EAAO;AACvBA,AECFwD,AHQC,AWuBD,IR/BAA,EFDExD,CAAC,ADCH,CCDIzB,AUgCA7B,IR/BI,CQ+BC,CR/BC,AQ+BAK,MAAN,CAAagG,CVhCf,KUgCE,GAAsB,CAA1B,EAA6B,OAAOrG,KAAP;AV/B3B4C,AStBN,APsBc,AQgCV,AT9BAA,AHYG,IGZHA,EDFEA,EUgCE/D,CZlBQQ,ED9Bd,CIkBU,AHYL,CIda0H,ADEP,AHYOzH,CEdN,AFcP,CEdQ,AUgCA,CZlBQ,EYkBLU,KRhCY,AQgCP,CRhCQ6G,AQgCPxG,EbhDT/C,GKgBqB,CAAC0J,AQgCnB,CAAa6C,AbhD7B,EAAoBtM,CagDJ,CRhCa,CAAY,AQgCvC,CRhC2B,CAAD,CLhB5B,CKgB6CqF,CLhBjB/E,KAA5B,EKgB4B,ALhBO,CKgBvB;AFCN0F,AEDM,AHSV,AWwBA,AbhDA,AIiBW1E,AHab,MGbaA,EDDP0E,CFcCjE,CD9BD9B,AC8BE,CCNDW,AWwBE,AZlBAoB,CEdC,CCCU,CDDR,ADQV,CCRW+D,ADQF5B,AEPW1B,CDDR,AHhBF,CGgBGwD,EHhBA,AC8BR,CGboB,AHaT,CGbU3E,CHarB,CD9BYf,CGgBN,AFcS0B,IEdI8D,AHhBX,AIiBO,CDDK,AHhBFhG,AIiBWyG,CDDRN,CDQ1B,CAA0B,ADMrB,CGbe,AHaS,CD9BD,AIiBWQ,AHalC,EAA2B,CEdtB,AHhBqB1G,EIiBX,AHaf,CAAP,EEdwC+F,CAAC,ADQvC,AFxBa,CGgB2BI,CDQDrC,AFxBAtD,GGgBD,CDQtC,AFxBa,CAA+BF,GGgBK,EHhBpC,CAAb,GGeW,GUkCNmC,KADE;AV/BH2D,ASvBR,APmB2B,AHYxB,AWyBG9E,AbjDF,AIgBS,AHcZ,GIlBa,CAAZ,CDIU,CSiCNA,ATjCF,EDAI8E,IAAI,CUiCC,AbjDF,CGgBG,CAACL,AUiCTzE,CVjCU,CAAC2E,AHhBFnG,Ka+CJ,EV/BI,AHhBJ,CAAYC,GGgBKgG,CAAC,CAACG,AHhBnB,EAAmBlG,KGgBhB,CHhBH,EAA2BC,EGgBI8F,CAAC,CAACI,EHhBjC,CAAP,CGgBsC,KAAW,MAFtC;AAGPE,AEDNxF,AQkCI+B,AbjDH,AIgBA,AHeH,EIhBE/B,IQkCI+B,EVjCEyD,EEDE,AQkCA,CRlCCqD,CFCC,EAAE,CAAC3D,AEDb,CFCc,AEDA5E,CFCC8E,OAAF,GEDb,CFC0BF,AEDAuD,CFCC,CAACpD,GED5B,IFCY,IUiCEzD,CVjC0BsD,CAAC,CAACI,EUiCvB,CAACvD,CVjCoB,GUiChC,EVjC2C,EUiCzBtB,OAAlB,EAHC;AVjCI,ASpBf,APuBEgI,AQkCIxG,AZlBN,EIhBEwG,IQkCIxG,CVrCQ,AEGP,CFHD,AEGE6G,IQkCI,CRlCV,oBQkCgBlH,KAAK,CAACK,MAAZ,CAJD;AV5BN,AEDHwG,AQkCI2C,ATlCJpF,AHgBF,EIhBEyC,ADAAzC,GDNE,CUwCEoF,CRlCC,CAACrC,GHQN,CW0BU,ERlCV,AQkCY,CTlCC,CAAChD,KAAD,CAAb,IFQMxC,UAAN,EAAkBX,MAAlB,EAA0B;AU/B5B,APwBC,AHO2B,AWqBjB,AT5BT,OS4BE,ET5BKoD,aAAP;ADCEhG,AECJ,AQiCG,ATlCF,IDAGA,QAAQ,CAACsD,gBAAT,CAA0B,SAA1B,EAAqC2B,SAArC;AACAQ,AECJ,AHKI,AELJ,AHaO,IEdHA,KFcYpE,CEdN,ADMFyB,CCNGQ,EDMA,EDQJ,CCROP,ADQSzB,IAAhB,EAAsB,KEdzB,CAAwB,GDMC,CAACiC,UAAU,CAACC,CCNrC,EAA0C,IDMhB,CAAmB,CAAnB,CAAD,EAAwB,CCNN0B,CAAD,EAAO,CDMKnF,GAA7B,CAAzB;ACLEmF,AECN,AHKI,AW4BF,ATjCF,AHaE3D,EAAAA,IEdI2D,AUkCAsG,CVlCC,CAAC/H,EDMAT,EW4BI,CAAC0H,CZpBC,CAAClJ,CCRD,EW4BZ,CX5BeoB,CW4BG,EVlCd,AFcJ,CAAqB,ECRA,CAACE,GAAD,CAAnB,CDQF,EAA+BrB,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA/B;AEbItB,AECN,AHKIuD,AW4BA,ATjCJ,AHaE,MEdIvD,ADMFuD,EW4BI9C,CZpBCa,IAAP,CEdY,CAAC8B,CDMD,AW4BC,CX5BAK,EW4BGxE,YX5Bd,GCNE,CAA6B,EUkCTkM,KAAR,CAAc,CVlC1B,CUkCY,CVlC4BlG,CUkCV,EAAlB,EAAsB,IVlClC,KUkCY,CAAd;AVjCC,AECL,AHKI,AELJ,AHaC,KEjBG,KDSI,CAACjC,MAAL,EAAa;ACLd,AECH,AQgCI,AZlBJ,WYkBW,mDACFpB,KADE;AR/BX,AHKI,AW4BEnB,AZnBN,MYmBMA,IX5BEwC,GW4BK,CX5BD,CW4BNxC,EX5BS,MW0BJ,GX1BHwC,IAAO,CAACC,SAAD,EAAe;AGJ9B,AHKM,AW4BAnB,ATnCC,AHgBP,MYmBMA,GTnCUyE,CSmCN,EX5BAnD,AW4BE,EAHD,CThCJ,CAAgB0C,EFOP,GAAGhD,AEPZ,EAAuBnB,KAAvB,EAA8B4C,MFOH,CAACtB,CEP5B,EAAwC,MFOH,CAACM,OAAV,CAAkB,CAAlB,CAAD,EAAuB,MAAI,CAACzD,GAA5B,CAA5B;AGJN,AHKM,AW4BAkC,ATnCJ,MSmCIA,KTnCKwE,CFODpD,AW4BE,EAAE,IX5BE,CAAChE,CAAP,CEPR,CAAoByD,EFOAA,CEPpB,EFOuB,AEPE,CFODzD,CAAhB,IAAqBgE,MAAM,CAAC/D,CAAP,IAAYwD,GAAG,CAACxD,CAAzC,EAA4C;AAC5CwD,AWuBK,AT9BP,OS8BA,CXvBEA,AEPI4D,GDDR,ADQO,GAAGrD,AEPI,GAAGS,GFOb,CEPiB,CAAC6C,IAAL,EACb,EDFM/E,KAAV,EAAiB;AACf,ADQEoB,AW4BH,ATlCGc,AHaC,IGbDA,IFMAd,AENI,CAAC4D,AHaKjF,EEfPC,CCEH,CAASkB,CFMH,CAACO,CCRT,ACEc,CAAChE,CAAJ,CDFEuC,EDQL,AENWmE,CFMjB,CDOC,CEfH,ECEwB,AHaK,CGbJ1G,CAAvB,EAA0B,CAA1B,IAA+ByE,IAAI,CAAC8C,GAAL,CAAS9D,GAAG,CAACxD,CAAJ,GAAQyG,KAAK,CAACzG,CAAvB,EAA0B,CAA1B,CAFlB,CAAf;ADCA,AECJ,AHOK,AELD,AHYF,MAAIsC,CCZF,CEAMiF,CCFD8B,EFDAjI,AFeE,GAAGe,CGZG,EDHb,CAAYiB,ACGIqD,AHYF,CIdlB,AJcmBlE,CIdCmH,GDEK,CCFzB,ADE0B3J,AHYZ,CGZM,AHYKkC,CIdCiD,CFDtB,CAAsB5C,ACGI8E,KDHC,CAACjG,AEChC,ADEI,ECFgC,CJcC,CAACqB,GEflC,IFeqB,CAAqB,QAArB,CAAX,CAAZ;AIbA,AQmCA,ATjCE,AHYF,MIdIkH,AQmCAwC,AZrBA,CAAC5J,CGZGkF,ECFA,EQmCE,AZrBV,CYqBWtB,CRnCC,AJcA,CGZG,ESiCf,CRnCA,ADEkBO,CSiCD,CRnCC,GDEK,CAACzG,CAAN,GAAUoH,MAA1B;ADNe,AEKjB,AHME,AW6BAqD,ATjCA,AHYFnI,EAAAA,IIdIqH,CJcC,CGZCpD,AHYA9D,ECRA2B,EGNI,AJcV,CCRS,AEJE,ECFE,AJcA9B,CCRD,AEJE,EAAZ,CCFesH,CJcC,CAACnH,ICRb2B,ADQO,CAAW1B,CYqBXwD,CX7BD,CGNC,AJcA,CACX,CIfF,AHMkB,AW6BhB,CAAgB5D,KAAK,CAACnB,OAAtB,IVrCiB,KAAK8D,QAHP;AAAA,AEMjB0E,AHMI,ADQF,EIdFA,MAAM,AHMF,ADQC/J,CIdEoE,IJcL,CCRM,CAACvD,GAAL,CAASqD,EDQRlE,IIdL,CAAwB,AJctB,MIdF,EAAgC,IHM5B,CAA6B,OGNK,IHMlC,EAA0C+D,IAA1C;AGLF,AQkCA,ATjCA,AHYA,QIbIkG,AJaMhK,CGZL,ESiCE,ERlCE,ADCAG,CAAC,AHYV,EIbY,CDCCwH,KHYH3H,EGZU,GAAGuH,CHYvB,IIbgB,CDChB,EAA+BpH,CAAC,CCDpB,EAAW,CDCawH,OAAO,CSiCxBlF,ETjC2B8E,GSiCvC,EAAP,CTjCA,EAAsDpH,CAAC,EAAvD,EAA2D;ADR5C,AEQb8J,AHKA,AW6BH,ATjCG,AHWF,MIZEA,EHKA,ADOgBhK,GGXX,CCDC,EAAE,AHKJ,ADON,CCPOW,AEJIV,CAAC,EFIV,CAAS+D,AEJIyD,GHWGzH,IGXI,EHWtB,CGXyBsH,MAAvB,EAA+BrH,CFI/B,AEJgC,CFIH,GEJOwH,OFIpC,AEJ2C,EFIF5D,CEJKyD,GFI9C,GEJA,EAAsDrH,CAAC,EAAvD,EAA2D;ADN7D,AEKU,AHMT,AEJG,AHUJ,OCTA,IDS+B,CGVrB0H,GCDNvC,AJW+BvF,KGVjB,GCDN,ADCS6E,CCDR,GDCY,CAAC6C,GHUK,CGVV,AHUsBzH,EGTrC,GHSyB,EAAmBC,MAAnB,EAA2BC,MAA3B,CAA/B,MEjBgC;AAAA,AEO1BqB,AQkCR,AThCQqD,AHQN,GADW,CAAb,EYyBI0H,EThCI1H,ECFArD,EQkCE,AThCE,CSgCDA,AThCEmG,CDTFlB,ECSH,CCFO,ADEErG,CDTiB,ACShB,CCFDgK,CQkCb,CThCiBxC,GSgCCjF,IThCd,CSgCmB,CAACwJ,AThCE,CAAtB,ICFyB,ADEEtH,CCFDqF,AQkCZ,GAAeuC,AThCE,CAAC9E,CCFP,EQkCQ,AThCN,CSgCO+E,AThCErM,CAAC,ESgCR,CThCWwH,ISgCE,GThCf,CSgCnC,CThCyD,CSgCD,AThCrB,CAFZ,CAAjB;ADNFpB,AEKW,AHMb,AW8BA,AZvBF9D,EAAAA,KAAK,CAACK,CIbQ,CFLVyD,AEIQ,CHOL3F,AW8BE,GVzCD,ADWN,ADOF,CElBS2C,ADWEY,EDOI1B,KAAK,CAACK,CElBjB,CAAeL,IFkBJ,CElBX,AFkBwBI,CCP1B,CAA0B,CDOb,CACb,SCRA,EAAuCiB,IAAvC,2BW+BKrB,KADE,GAEF4J,MAFE;AVxCN,AEGS,AHQV,AWgCEzJ,ATlCE,AHSJ,MYyBEA,CRzCqB,CJgBpB7C,EYyBG,CXhCDa,CEFGgH,CHSR,CCPA,CAASzD,KEFO,EHSbpE,EGTiBwH,GHSpB,GGTI,CFEJ,CAA0B,AEFE,SSkChB9E,CXhCZ,EAAsC8B,EWgCrB,CXhCjB,AWgCkB3B,IAAZ,IAAkBH,KAAK,CAACnB,OAAxB,EAHC;AV7CQ,AEYb6I,AHKH,AWgCG,ATlCIzD,AHQN,MIXEyD,EJWQnK,CIXL,CDGC0G,CCHCoD,GJWP,CGRW,CAAC1C,CCHC,CAACgD,EDGR,CAAW,EHQPpK,MAAV;AEvBe,AEOQ,AQ2CrB,ATnCiBE,AHQnB,KIhBY,CAAZ,EJgBkBD,IGRCC,CAAC,CHQpB,CGRmBA,CAAF,OHQCD,MAAlB;AEvBe,AEchB,AQqCG6C,ATpCoB3C,AHQtB,GIjBF,GQ6CI2C,KZ5B6B,CY4BvB,ATpCc3C,CAAC,CSoCb,CTpCYA,AHQaL,CYsB5B,AT9BU,eHQc,CAAYC,KAAZ,EAAmBC,MAAnB,EAA2BC,MAA3B,CAA/B;AEvBe,AEejB6J,AQqCImC,ATrCuB3L,AHQzB,EIRFwJ,CJOe,CAAf,EY8BImC,ERrCE,CAAC5B,GQqCG,ATrCiB/J,ESqCfiM,GTrCoB,CSqChB,CAACC,ATrCiB/J,GCAlC,AQqCY,CRrCSoH,CDAkB,CAACvJ,ECAxC;AFfiB,AEgBlB,AQ6BU,AT9BU,AHUnBmC,EAAAA,KYoBE,AZpBG,CAACnB,GGVE,IHUR,GAAgB,IAAIxB,gBAAJ,CACd2C,KAAK,CAACnB,OAAN,CAAcvB,KADA,EAEd0C,KAAK,CAACnB,OAAN,CAActB,MAFA,EAGdyC,KAAK,CAACnB,OAAN,CAAcrB,MAHA,CAAhB;AEnBC,AUgDA,ATtCM,AHcP,SAAOwC,KAAP;AIZF,ADDO,AHcN,SIbQyH,gBAAT,CAA0BF,KAA1B,EAAiC;AAC/B,AQoCA,ATrCG,MCCCjK,GQoCG,ERpCE,GAAG4E,IAAI,CAACoC,GAAL,CAAS,GAAT,EAAciD,KAAK,CAACjK,KAApB,CAAZ,oBQoCmB0C,KAAZ,GAAsB4J,MAAtB,EAAP;ARnCA,AHAF,AWoCC,MRpCKrM,GHAG4D,GGAG,GAAGe,IAAI,CAACoC,GAAL,CAAS,AHAxB,CAAyBpD,EGAV,CHAf,CGA6BqG,CHACxF,IGAI,CAACxE,EHAnC,EAAuC,EGAxB,CAAb;AACA,AHAA,AEFEqF,IAAAA,ECEE9D,AHAAkD,IAAI,EGAE,ADFA,CFECD,AEFA,ECEE,KHAK,CAACE,UGAF,QAAJ,EAAc,CHAhB,EAAX;AGA6B3E,AHC7B,AWoCF,ATvCeuB,ICEgBvB,EDFhBuB,GCEqB,AHC3B,AWoCAmL,ERrCsB1M,EDFT,EAAE0C,CCEK,IDFA,CAACnB,ISuC9B,GTvCwB,CAAckF,GS2CnC,CT3CqB,CAAmBE,KAAnB;ACEc1G,AHElCE,AWuCD,AT3CU,ICEyBF,AHElCE,CAAC,AEJO,CAAR,CFIGyE,GGFqC,CHEjC,CGF2B3E,AHE1B4E,KAAL,CAAW,CAACjB,GAAG,CAACkB,OAAJ,GAAcJ,IAAI,CAACK,IAApB,IAA4B/B,KAAvC,CADE;AGDoB,AHGzB5C,AEJD,GCCY,CAAb,AHGEA,CAAC,EAAEwE,IAAI,CAACC,KAAL,CAAW,CAACjB,GAAG,CAACoB,OAAJ,GAAcN,IAAI,CAACO,GAApB,IAA2BjC,KAAtC;AGFL,AHAO,AWwCN,GXxCD,GGAItB,GAAG,GAAGF,MAAM,CAACG,KQqCjBe,KRrCU,AQwCT,CRxC2B,IAAlB,CAAV;AACAhB,AHGD,AWoCE,ATzCD6F,ECEA7F,ADFA6F,GCEG,CAACgD,AQoCJ7H,KAGC,CTzCS,CAACmE,ECEX,CAAcoD,EDFJ,CAAV,ECEA,EAAqB,CAArB,EAAwB,CAAxB,8BQoCQ,4BAGP,6DAH2B+B,aAG3B;ARtCD,AQsCC,ATxCD,MCEI9L,GDFGqH,GCEG,GAAG,EAAb,CAN+B,CAO/B,ADHA,KSsCAnC,KAEC;ARpCD,AQo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","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["/**\n * This class represents the picture in the canvas\n */\nexport class Picture {\n  constructor(width, height, pixels) {\n    this.width = width\n    this.height = height\n    this.pixels = pixels\n  }\n\n  static empty(width, height, color) {\n    let pixels = new Array(width * height).fill(color)\n    return new Picture(width, height, pixels)\n  }\n\n  pixel(x, y) {\n    return this.pixels[x + y * this.width]\n  }\n\n  draw(pixels) {\n    let copy = this.pixels.slice()\n    for (let { x, y, color } of pixels) {\n      copy[x + y * this.width] = color\n    }\n    return new Picture(this.width, this.height, copy)\n  }\n}\n","import { Picture } from './picture'\n\n/**\n * A less verbose DOM builder\n */\nexport function elt(type, props, ...children) {\n  let dom = document.createElement(type)\n  if (props) {\n    Object.assign(dom, props)\n  }\n  for (let child of children) {\n    if (typeof child !== 'string') {\n      dom.appendChild(child)\n    } else {\n      dom.appendChild(document.createTextNode(child))\n    }\n  }\n  return dom\n}\n\n/**\n * Draws picture into the canvas\n */\nexport function drawPicture(picture, canvas, scale) {\n  canvas.width = picture.width * scale\n  canvas.height = picture.height * scale\n  let ctx = canvas.getContext('2d')\n\n  for (let y = 0; y < picture.height; y++) {\n    for (let x = 0; x < picture.width; x++) {\n      ctx.fillStyle = picture.pixel(x, y)\n      ctx.fillRect(x * scale, y * scale, scale, scale)\n    }\n  }\n}\n\n/**\n * A hex helper function facilitate conversion of from 8 bit\n * numerical presentation of color to base-16.\n */\nexport function hex(n) {\n  return n.toString(16).padStart(2, '0')\n}\n\n/**\n * Cache data to local storage\n */\nexport function cached(data) {\n  localStorage.setItem('_state', JSON.stringify(data))\n  return data\n}\n\n/**\n * Get cached state from local storage\n */\nexport function getCachedState() {\n  let state = JSON.parse(localStorage.getItem('_state'))\n  if (!state) return\n  state.done = state.done.map(\n    ({ width, height, pixels }) => new Picture(width, height, pixels)\n  )\n  state.redone = state.redone.map(\n    ({ width, height, pixels }) => new Picture(width, height, pixels)\n  )\n  state.picture = new Picture(\n    state.picture.width,\n    state.picture.height,\n    state.picture.pixels\n  )\n  return state\n}\n","import { drawPicture, elt } from '../utils'\n\nexport const SCALE = 15\n\nexport class PictureCanvas {\n  constructor(picture, pointerDown) {\n    this.dom = elt('canvas', {\n      onmousedown: (event) => this.mouse(event, pointerDown),\n      ontouchstart: (event) => this.touch(event, pointerDown),\n    })\n    this.syncState(picture)\n  }\n\n  syncState(picture) {\n    if (this.picture == picture) return\n    this.picture = picture\n    drawPicture(this.picture, this.dom, SCALE)\n  }\n\n  mouse(downEvent, onDown) {\n    // return if not a left click\n    if (downEvent.button != 0) return\n    let pos = pointerPosition(downEvent, this.dom)\n    let onMove = onDown(pos)\n    if (!onMove) return\n\n    let move = (moveEvent) => {\n      if (moveEvent.buttons == 0) {\n        this.dom.removeEventListener('mousemove', move)\n      } else {\n        let newPos = pointerPosition(moveEvent, this.dom)\n        if (newPos.x == pos.x && newPos.y == pos.y) return\n        onMove(newPos)\n      }\n    }\n    this.dom.addEventListener('mousemove', move)\n  }\n\n  touch(startEvent, onDown) {\n    let pos = pointerPosition(startEvent.touches[0], this.dom)\n    let onMove = onDown(pos)\n    startEvent.preventDefault()\n    if (!onMove) return\n\n    let move = (moveEvent) => {\n      let newPos = pointerPosition(moveEvent.touches[0], this.dom)\n      if (newPos.x == pos.x && newPos.y == pos.y) return\n      pos = newPos\n      onMove(newPos)\n    }\n    let end = () => {\n      this.dom.removeEventListener('touchmove', move)\n      this.dom.removeEventListener('touchend', move)\n    }\n    this.dom.addEventListener('touchmove', move)\n    this.dom.addEventListener('touchend', end)\n  }\n}\n\nfunction pointerPosition(pos, domNode) {\n  let rect = domNode.getBoundingClientRect()\n  return {\n    x: Math.floor((pos.clientX - rect.left) / SCALE),\n    y: Math.floor((pos.clientY - rect.top) / SCALE),\n  }\n}\n","import { PictureCanvas } from './components/picture-canvas'\nimport { elt } from './utils'\n\nexport class PixelEditor {\n  constructor(state, config) {\n    let { tools, controls, dispatch } = config\n    this.state = state\n    this.canvas = new PictureCanvas(state.picture, (pos) => {\n      let selectedTool = tools[this.state.tool]\n      // call the selected tool util in ./src/tools.js\n      let drawFunction = selectedTool(pos, this.state, dispatch)\n      if (drawFunction) {\n        // call the function returned by the selected tool\n        return (pos) => drawFunction(pos, this.state)\n      }\n    })\n    this.controls = controls.map((Control) => new Control(state, config))\n    this.dom = elt(\n      'div',\n      {},\n      this.canvas.dom,\n      elt('br'),\n      ...this.controls.reduce((a, c) => a.concat(' ', c.dom), [])\n    )\n    const onKeyDown = (e) => {\n      e.preventDefault()\n      dispatch({\n        undo: (e.metaKey || e.ctrlKey) && e.code === 'KeyZ',\n        redo: (e.metaKey || e.ctrlKey) && e.code === 'KeyY',\n        save: (e.metaKey || e.ctrlKey) && e.code === 'KeyS',\n      })\n    }\n    document.addEventListener('keydown', onKeyDown)\n    window.addEventListener('onbeforeunload', (e) => {\n      e.preventDefault()\n      document.removeEventListener('keydown', onKeyDown)\n    })\n  }\n\n  syncState(state) {\n    this.state = state\n    this.canvas.syncState(state.picture)\n    for (let ctrl of this.controls) {\n      ctrl.syncState(state)\n    }\n  }\n}\n","/**\n * The draw tool\n */\nexport function draw(pos, state, dispatch) {\n  function drawPixel({ x, y }, state) {\n    let drawn = { x, y, color: state.color }\n    dispatch({ picture: state.picture.draw([drawn]) })\n  }\n  // immediate call to drawPixel and a return call of the same function\n  drawPixel(pos, state)\n  return drawPixel\n}\n\n/**\n * To draw larger shapes, it can be useful to quickly create rectangles.\n */\nexport function rectangle(start, state, dispatch) {\n  function drawRectangle(pos) {\n    let xStart = Math.min(start.x, pos.x)\n    let yStart = Math.min(start.y, pos.y)\n    let xEnd = Math.max(start.x, pos.x)\n    let yEnd = Math.max(start.y, pos.y)\n    let drawn = []\n    for (let y = yStart; y <= yEnd; y++) {\n      for (let x = xStart; x <= xEnd; x++) {\n        drawn.push({ x, y, color: state.color })\n      }\n    }\n    dispatch({ picture: state.picture.draw(drawn) })\n  }\n  drawRectangle(start)\n  return drawRectangle\n}\n\n/**\n * To quickly draw circles\n * assisted by chatGPT\n */\nexport function circle(start, state, dispatch) {\n  function drawCircle(pos) {\n    const radius = Math.sqrt(\n      // eslint-disable-next-line no-restricted-properties\n      Math.pow(pos.x - start.x, 2) + Math.pow(pos.y - start.y, 2)\n    )\n    const centerX = start.x + radius\n    const centerY = start.y + radius\n    let drawn = []\n    for (let y = centerY - radius; y <= centerY + radius; y++) {\n      for (let x = centerX - radius; x <= centerX + radius; x++) {\n        const distance = Math.sqrt(\n          // eslint-disable-next-line no-restricted-properties\n          Math.pow(x - centerX, 2) + Math.pow(y - centerY, 2)\n        )\n        if (distance <= radius) {\n          drawn.push({ x, y, color: state.color })\n        }\n      }\n    }\n    dispatch({ picture: state.picture.draw(drawn) })\n  }\n  drawCircle(start)\n  return drawCircle\n}\n\n/**\n * This function uses the Bresenham's line algorithm to draw a triangle\n * on the canvas\n * assisted by chatGPT\n */\nexport function triangle(start, state, dispatch) {\n  function drawTriangle(pos) {\n    const x1 = start.x\n    const y1 = start.y\n    const x2 = pos.x\n    const y2 = pos.y\n    const deltaX = Math.abs(x2 - x1)\n    const deltaY = Math.abs(y2 - y1)\n    const signX = x1 < x2 ? 1 : -1\n    const signY = y1 < y2 ? 1 : -1\n    let x = x1\n    let y = y1\n    let error = deltaX - deltaY\n    let drawn = []\n\n    while (x !== x2 || y !== y2) {\n      drawn.push({ x, y, color: state.color })\n      const error2 = 2 * error\n      if (error2 > -deltaY) {\n        error -= deltaY\n        x += signX\n      }\n      if (error2 < deltaX) {\n        error += deltaX\n        y += signY\n      }\n    }\n    drawn.push({ x: x2, y: y2, color: state.color })\n\n    dispatch({ picture: state.picture.draw(drawn) })\n  }\n\n  drawTriangle(start)\n  return drawTriangle\n}\n\nconst around = [\n  { dx: -1, dy: 0 },\n  { dx: 1, dy: 0 },\n  { dx: 0, dy: -1 },\n  { dx: 0, dy: 1 },\n]\n\n/**\n * Flood fill tool.\n */\nexport function fill({ x, y }, state, dispatch) {\n  let targetColor = state.picture.pixel(x, y)\n  let drawn = [{ x, y, color: state.color }]\n  for (let done = 0; done < drawn.length; done++) {\n    for (let { dx, dy } of around) {\n      // eslint-disable-next-line one-var\n      let x = drawn[done].x + dx,\n        y = drawn[done].y + dy\n      if (\n        x >= 0 &&\n        x < state.picture.width &&\n        y >= 0 &&\n        y < state.picture.height &&\n        state.picture.pixel(x, y) == targetColor &&\n        !drawn.some((p) => p.x == x && p.y == y)\n      ) {\n        drawn.push({ x, y, color: state.color })\n      }\n    }\n  }\n  dispatch({ picture: state.picture.draw(drawn) })\n}\n\n/**\n * Color picker tool\n */\nexport function pick(pos, state, dispatch) {\n  dispatch({ color: state.picture.pixel(pos.x, pos.y) })\n}\n","import { elt, hex } from '../utils'\nimport { Picture } from '../picture'\n\nexport class LoadButton {\n  constructor(_, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => startLoad(dispatch),\n      },\n      '📁 Load'\n    )\n  }\n\n  syncState() {\n    // unimplemented\n  }\n}\n\n/**\n * Gets the file from the user's computer through use of an `<input>` HTML element with the `file` attribute\n * @param {*} dispatch\n */\nfunction startLoad(dispatch) {\n  let input = elt('input', {\n    type: 'file',\n    onchange: () => finishLoad(input.files[0], dispatch),\n  })\n  document.body.appendChild(input)\n  input.click()\n  input.remove()\n}\n\n/**\n * When the user has selected a file, we use the `FileReader` to\n * get access to its contents, again as a data URL.\n * This URL can be used to create a `<img>` element; since we can't\n * get direct access to the pixels in such an image, we can't create\n * a `Picture` object from that. A call to `pictureFromImage` handles this conversion.\n * @param {*} file\n * @param {*} dispatch\n */\nfunction finishLoad(file, dispatch) {\n  if (file == null) return\n  let reader = new FileReader()\n  reader.addEventListener('load', () => {\n    let image = elt('img', {\n      onload: () =>\n        dispatch({\n          picture: pictureFromImage(image),\n        }),\n      src: reader.result,\n    })\n  })\n  reader.readAsDataURL(file)\n}\n\nfunction pictureFromImage(image) {\n  let width = Math.min(100, image.width)\n  let height = Math.min(100, image.height)\n  let canvas = elt('canvas', { width, height })\n  let ctx = canvas.getContext('2d')\n  ctx.drawImage(image, 0, 0)\n  let pixels = []\n  // this data property is an array of color components\n  // contains 4 values which represent reg, green, blue and alpha (for transparency) of the pixel's color as 8 bit numbers (0-255)\n  let { data } = ctx.getImageData(0, 0, width, height)\n\n  for (let i = 0; i < data.length; i += 4) {\n    let [r, g, b] = data.slice(i, i + 3)\n    pixels.push(`#${hex(r)}${hex(g)}${hex(b)}`)\n  }\n  return new Picture(width, height, pixels)\n}\n","import { drawPicture, elt } from '../utils'\nimport { SCALE } from './picture-canvas'\n\nexport class SaveButton {\n  constructor(state, { dispatch }) {\n    this.picture = state.picture\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => dispatch({ save: true }),\n      },\n      '💾 Save'\n    )\n  }\n\n  static save(picture) {\n    let canvas = elt('canvas')\n    drawPicture(picture, canvas, SCALE)\n    let link = elt('a', {\n      href: canvas.toDataURL(),\n      // eslint-disable-next-line no-alert\n      download: `${prompt('save file as?', 'pixel-art') ?? 'pixel-art'}.png`,\n    })\n    document.body.appendChild(link)\n    link.click()\n    link.remove()\n  }\n\n  syncState(state) {\n    this.picture = state.picture\n  }\n}\n","import { elt } from '../utils'\n\nexport class UndoButton {\n  constructor(state, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => dispatch({ undo: true }),\n        disabled: state.done.length < 2,\n      },\n      '⤴ Undo'\n    )\n  }\n\n  syncState(state) {\n    this.dom.disabled = state.done.length < 2\n  }\n}\n","import { elt } from '../utils'\n\nexport class RedoButton {\n  constructor(state, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => dispatch({ redo: true }),\n        disabled: state.redone.length < 1,\n      },\n      '⤵ Redo'\n    )\n  }\n\n  syncState(state) {\n    this.dom.disabled = state.redone.length < 1\n  }\n}\n","import { elt } from '../utils'\n\nexport class ResetButton {\n  constructor(state, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => {\n          // eslint-disable-next-line no-restricted-globals, no-alert\n          if (confirm('Are you sure you want to reset the canvas?')) {\n            dispatch({ reset: true })\n          }\n        },\n        disabled: !state.done.length,\n      },\n      '🔁 Reset'\n    )\n  }\n\n  syncState(state) {\n    this.dom.disabled = !state.done.length\n  }\n}\n","import { elt } from '../utils'\n\nexport class ToolSelect {\n  constructor(state, { tools, dispatch }) {\n    this.select = elt(\n      'select',\n      {\n        onchange: () => dispatch({ tool: this.select.value }),\n      },\n      ...Object.keys(tools).map((name) =>\n        elt(\n          'option',\n          {\n            selected: name == state.tool,\n          },\n          name\n        )\n      )\n    )\n    this.dom = elt('label', null, 'Tool: ', this.select)\n  }\n\n  /**\n   * Sync ToolSelect state\n   * @param {*} state\n   */\n  syncState(state) {\n    this.select.value = state.tool\n  }\n}\n","import { elt } from '../utils'\n\nexport class ColorSelect {\n  constructor(state, { dispatch }) {\n    this.input = elt('input', {\n      type: 'color',\n      value: state.color,\n      onchange: () => dispatch({ color: this.input.value }),\n    })\n    this.dom = elt('label', null, '🎨 Color: ', this.input)\n  }\n\n  /**\n   * Sync the ColorSelect state\n   * @param {*} state\n   */\n  syncState(state) {\n    this.input.value = state.color\n  }\n}\n","import { LoadButton } from './load-button'\nimport { PictureCanvas } from './picture-canvas'\nimport { SaveButton } from './save-button'\nimport { UndoButton } from './undo-button'\nimport { RedoButton } from './redo-button'\nimport { ResetButton } from './reset-button'\nimport { ToolSelect } from './tool-select'\nimport { ColorSelect } from './color-select'\n\nexport {\n  LoadButton,\n  PictureCanvas,\n  SaveButton,\n  UndoButton,\n  RedoButton,\n  ResetButton,\n  ToolSelect,\n  ColorSelect,\n}\n","import { PixelEditor } from './app'\nimport { draw, fill, pick, rectangle, circle, triangle } from './tools'\nimport {\n  LoadButton,\n  SaveButton,\n  UndoButton,\n  RedoButton,\n  ResetButton,\n  ToolSelect,\n  ColorSelect,\n} from './components'\nimport { Picture } from './picture'\nimport { cached, getCachedState } from './utils'\n\nconst INITIAL_STATE = {\n  tool: 'draw',\n  color: '#000000',\n  picture: Picture.empty(60, 30, '#f0f0f0'),\n  done: [],\n  redone: [],\n  doneAt: 0,\n}\n\nconst baseTools = {\n  draw,\n  fill,\n  pick,\n  rectangle,\n  circle,\n  triangle,\n}\n\nconst baseControls = [\n  ToolSelect,\n  ColorSelect,\n  SaveButton,\n  LoadButton,\n  UndoButton,\n  RedoButton,\n  ResetButton,\n]\n\n// quasi - reducer function\nfunction historyUpdateState(state, action) {\n  if (action.undo) {\n    if (state.done.length < 2) return state\n    let redone = state.done.pop()\n    return cached({\n      ...state,\n      picture: state.done[state.done.length - 1],\n      done: [...state.done],\n      redone: [...state.redone, redone],\n      doneAt: 0,\n    })\n  }\n\n  if (action.redo) {\n    if (state.redone.length < 1) return state\n    let picture = state.redone.pop()\n    return cached({\n      ...state,\n      picture,\n      done: [...state.done, picture],\n      redone: [...state.redone],\n      doneAt: 0,\n    })\n  }\n\n  if (action.reset) {\n    let picture = Picture.empty(60, 30, '#f0f0f0')\n    return cached({\n      ...state,\n      picture,\n      done: [],\n      redone: [],\n    })\n  }\n\n  if (action.save) {\n    SaveButton.save(state.picture)\n    return cached({ ...state })\n  }\n\n  if (action.picture && state.doneAt < Date.now() - 1000) {\n    return cached({\n      ...state,\n      ...action,\n      done: [...state.done, state.picture],\n      // redone state only relevant on undo, otherwise it remains empty\n      // on regular picture action\n      redone: [],\n      doneAt: Date.now(),\n    })\n  }\n  return cached({ ...state, ...action })\n}\n\nfunction startPixelEditor({\n  state = getCachedState() ?? INITIAL_STATE,\n  tools = baseTools,\n  controls = baseControls,\n}) {\n  const app = new PixelEditor(state, {\n    tools,\n    controls,\n    dispatch(action) {\n      state = historyUpdateState(state, action)\n      app.syncState(state)\n    },\n  })\n  return app.dom\n}\n\ndocument.getElementById('root').appendChild(startPixelEditor({}))\n"]}