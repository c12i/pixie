{"version":3,"sources":["picture.js","utils.js","components/picture-canvas.js","app.js","tools.js","components/load-button.js","components/save-button.js","components/undo-button.js","components/redo-button.js","components/reset-button.js","components/tool-select.js","components/color-select.js","components/index.js","index.js"],"names":["Picture","width","height","pixels","x","y","copy","slice","color","Array","fill","elt","type","props","dom","document","createElement","Object","assign","children","child","appendChild","createTextNode","drawPicture","picture","canvas","scale","ctx","getContext","fillStyle","pixel","fillRect","hex","n","toString","padStart","cached","data","localStorage","setItem","JSON","stringify","getCachedState","state","parse","getItem","done","map","redone","isMobileBrowser","check","a","navigator","userAgent","vendor","window","opera","test","substr","SCALE","PictureCanvas","pointerDown","onmousedown","event","mouse","ontouchstart","touch","syncState","downEvent","onDown","button","pos","pointerPosition","onMove","addEventListener","move","moveEvent","buttons","removeEventListener","newPos","startEvent","touches","preventDefault","domNode","rect","getBoundingClientRect","Math","floor","clientX","left","clientY","top","PixelEditor","config","tools","controls","dispatch","selectedTool","drawFunction","tool","Control","reduce","c","concat","onKeyDown","e","undo","metaKey","ctrlKey","code","redo","save","draw","drawPixel","drawn","rectangle","start","drawRectangle","xStart","min","yStart","xEnd","max","yEnd","push","circle","drawCircle","radius","sqrt","pow","centerX","centerY","triangle","drawTriangle","x1","y1","x2","y2","deltaX","abs","deltaY","signX","signY","error","error2","around","dx","dy","targetColor","length","some","p","pick","LoadButton","_","onclick","startLoad","input","onchange","finishLoad","files","body","click","remove","file","reader","FileReader","image","onload","pictureFromImage","src","result","readAsDataURL","drawImage","getImageData","i","r","g","b","SaveButton","link","href","toDataURL","download","prompt","UndoButton","disabled","RedoButton","ResetButton","confirm","reset","ToolSelect","select","value","keys","name","selected","ColorSelect","INITIAL_STATE","empty","doneAt","baseTools","baseControls","historyUpdateState","action","pop","Date","now","startPixelEditor","app","console","info","getElementById"],"mappings":"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","file":"src.d437c26f.js","sourceRoot":"../src","sourcesContent":["/**\n * This class represents the picture in the canvas\n */\nexport class Picture {\n  constructor(width, height, pixels) {\n    this.width = width\n    this.height = height\n    this.pixels = pixels\n  }\n\n  static empty(width, height, color) {\n    let pixels = new Array(width * height).fill(color)\n    return new Picture(width, height, pixels)\n  }\n\n  pixel(x, y) {\n    return this.pixels[x + y * this.width]\n  }\n\n  draw(pixels) {\n    let copy = this.pixels.slice()\n    for (let { x, y, color } of pixels) {\n      copy[x + y * this.width] = color\n    }\n    return new Picture(this.width, this.height, copy)\n  }\n}\n","import { Picture } from './picture'\n\n/**\n * A less verbose DOM builder\n */\nexport function elt(type, props, ...children) {\n  let dom = document.createElement(type)\n  if (props) {\n    Object.assign(dom, props)\n  }\n  for (let child of children) {\n    if (typeof child !== 'string') {\n      dom.appendChild(child)\n    } else {\n      dom.appendChild(document.createTextNode(child))\n    }\n  }\n  return dom\n}\n\n/**\n * Draws picture into the canvas\n */\nexport function drawPicture(picture, canvas, scale) {\n  canvas.width = picture.width * scale\n  canvas.height = picture.height * scale\n  let ctx = canvas.getContext('2d')\n\n  for (let y = 0; y < picture.height; y++) {\n    for (let x = 0; x < picture.width; x++) {\n      ctx.fillStyle = picture.pixel(x, y)\n      ctx.fillRect(x * scale, y * scale, scale, scale)\n    }\n  }\n}\n\n/**\n * A hex helper function facilitate conversion of from 8 bit\n * numerical presentation of color to base-16.\n */\nexport function hex(n) {\n  return n.toString(16).padStart(2, '0')\n}\n\n/**\n * Cache data to local storage\n */\nexport function cached(data) {\n  localStorage.setItem('_state', JSON.stringify(data))\n  return data\n}\n\n/**\n * Get cached state from local storage\n */\nexport function getCachedState() {\n  let state = JSON.parse(localStorage.getItem('_state'))\n  if (!state) return\n  state.done = state.done.map(\n    ({ width, height, pixels }) => new Picture(width, height, pixels)\n  )\n  state.redone = state.redone.map(\n    ({ width, height, pixels }) => new Picture(width, height, pixels)\n  )\n  state.picture = new Picture(\n    state.picture.width,\n    state.picture.height,\n    state.picture.pixels\n  )\n  return state\n}\n\n/**\n * Check if mobile browser\n */\n/* eslint-disable */\nexport function isMobileBrowser() {\n  let check = false;\n  (function(a) {if ((/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i).test(a) || (/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i).test(a.substr(0, 4))) check = true})(navigator.userAgent || navigator.vendor || window.opera)\n  return check\n}\n\n","import { drawPicture, elt, isMobileBrowser } from '../utils'\n\nexport const SCALE = isMobileBrowser() ? 10 : 15\n\nexport class PictureCanvas {\n  constructor(picture, pointerDown) {\n    this.dom = elt('canvas', {\n      onmousedown: (event) => this.mouse(event, pointerDown),\n      ontouchstart: (event) => this.touch(event, pointerDown),\n    })\n    this.syncState(picture)\n  }\n\n  syncState(picture) {\n    if (this.picture == picture) return\n    this.picture = picture\n    drawPicture(this.picture, this.dom, SCALE)\n  }\n\n  mouse(downEvent, onDown) {\n    // return if not a left click\n    if (downEvent.button != 0) return\n    let pos = pointerPosition(downEvent, this.dom)\n    let onMove = onDown(pos)\n    if (!onMove) return\n\n    let move = (moveEvent) => {\n      if (moveEvent.buttons == 0) {\n        this.dom.removeEventListener('mousemove', move)\n      } else {\n        let newPos = pointerPosition(moveEvent, this.dom)\n        if (newPos.x == pos.x && newPos.y == pos.y) return\n        onMove(newPos)\n      }\n    }\n    this.dom.addEventListener('mousemove', move)\n  }\n\n  touch(startEvent, onDown) {\n    let pos = pointerPosition(startEvent.touches[0], this.dom)\n    let onMove = onDown(pos)\n    startEvent.preventDefault()\n    if (!onMove) return\n\n    let move = (moveEvent) => {\n      let newPos = pointerPosition(moveEvent.touches[0], this.dom)\n      if (newPos.x == pos.x && newPos.y == pos.y) return\n      pos = newPos\n      onMove(newPos)\n    }\n    let end = () => {\n      this.dom.removeEventListener('touchmove', move)\n      this.dom.removeEventListener('touchend', move)\n    }\n    this.dom.addEventListener('touchmove', move)\n    this.dom.addEventListener('touchend', end)\n  }\n}\n\nfunction pointerPosition(pos, domNode) {\n  let rect = domNode.getBoundingClientRect()\n  return {\n    x: Math.floor((pos.clientX - rect.left) / SCALE),\n    y: Math.floor((pos.clientY - rect.top) / SCALE),\n  }\n}\n","import { PictureCanvas } from './components/picture-canvas'\nimport { elt } from './utils'\n\nexport class PixelEditor {\n  constructor(state, config) {\n    let { tools, controls, dispatch } = config\n    this.state = state\n    this.canvas = new PictureCanvas(state.picture, (pos) => {\n      let selectedTool = tools[this.state.tool]\n      // call the selected tool util in ./src/tools.js\n      let drawFunction = selectedTool(pos, this.state, dispatch)\n      if (drawFunction) {\n        // call the function returned by the selected tool\n        return (pos) => drawFunction(pos, this.state)\n      }\n    })\n    this.controls = controls.map((Control) => new Control(state, config))\n    this.dom = elt(\n      'div',\n      {},\n      this.canvas.dom,\n      elt('br'),\n      ...this.controls.reduce((a, c) => a.concat(' ', c.dom), [])\n    )\n    const onKeyDown = (e) => {\n      e.preventDefault()\n      dispatch({\n        undo: (e.metaKey || e.ctrlKey) && e.code === 'KeyZ',\n        redo: (e.metaKey || e.ctrlKey) && e.code === 'KeyY',\n        save: (e.metaKey || e.ctrlKey) && e.code === 'KeyS',\n      })\n    }\n    document.addEventListener('keydown', onKeyDown)\n    window.addEventListener('onbeforeunload', (e) => {\n      e.preventDefault()\n      document.removeEventListener('keydown', onKeyDown)\n    })\n  }\n\n  syncState(state) {\n    this.state = state\n    this.canvas.syncState(state.picture)\n    for (let ctrl of this.controls) {\n      ctrl.syncState(state)\n    }\n  }\n}\n","/**\n * The draw tool\n */\nexport function draw(pos, state, dispatch) {\n  function drawPixel({ x, y }, state) {\n    let drawn = { x, y, color: state.color }\n    dispatch({ picture: state.picture.draw([drawn]) })\n  }\n  // immediate call to drawPixel and a return call of the same function\n  drawPixel(pos, state)\n  return drawPixel\n}\n\n/**\n * To draw larger shapes, it can be useful to quickly create rectangles.\n */\nexport function rectangle(start, state, dispatch) {\n  function drawRectangle(pos) {\n    let xStart = Math.min(start.x, pos.x)\n    let yStart = Math.min(start.y, pos.y)\n    let xEnd = Math.max(start.x, pos.x)\n    let yEnd = Math.max(start.y, pos.y)\n    let drawn = []\n    for (let y = yStart; y <= yEnd; y++) {\n      for (let x = xStart; x <= xEnd; x++) {\n        drawn.push({ x, y, color: state.color })\n      }\n    }\n    dispatch({ picture: state.picture.draw(drawn) })\n  }\n  drawRectangle(start)\n  return drawRectangle\n}\n\n/**\n * To quickly draw circles\n * assisted by chatGPT\n */\nexport function circle(start, state, dispatch) {\n  function drawCircle(pos) {\n    const radius = Math.sqrt(\n      // eslint-disable-next-line no-restricted-properties\n      Math.pow(pos.x - start.x, 2) + Math.pow(pos.y - start.y, 2)\n    )\n    const centerX = start.x + radius\n    const centerY = start.y + radius\n    let drawn = []\n    for (let y = centerY - radius; y <= centerY + radius; y++) {\n      for (let x = centerX - radius; x <= centerX + radius; x++) {\n        const distance = Math.sqrt(\n          // eslint-disable-next-line no-restricted-properties\n          Math.pow(x - centerX, 2) + Math.pow(y - centerY, 2)\n        )\n        if (distance <= radius) {\n          drawn.push({ x, y, color: state.color })\n        }\n      }\n    }\n    dispatch({ picture: state.picture.draw(drawn) })\n  }\n  drawCircle(start)\n  return drawCircle\n}\n\n/**\n * This function uses the Bresenham's line algorithm to draw a triangle\n * on the canvas\n * assisted by chatGPT\n */\nexport function triangle(start, state, dispatch) {\n  function drawTriangle(pos) {\n    const x1 = start.x\n    const y1 = start.y\n    const x2 = pos.x\n    const y2 = pos.y\n    const deltaX = Math.abs(x2 - x1)\n    const deltaY = Math.abs(y2 - y1)\n    const signX = x1 < x2 ? 1 : -1\n    const signY = y1 < y2 ? 1 : -1\n    let x = x1\n    let y = y1\n    let error = deltaX - deltaY\n    let drawn = []\n\n    while (x !== x2 || y !== y2) {\n      drawn.push({ x, y, color: state.color })\n      const error2 = 2 * error\n      if (error2 > -deltaY) {\n        error -= deltaY\n        x += signX\n      }\n      if (error2 < deltaX) {\n        error += deltaX\n        y += signY\n      }\n    }\n    drawn.push({ x: x2, y: y2, color: state.color })\n\n    dispatch({ picture: state.picture.draw(drawn) })\n  }\n\n  drawTriangle(start)\n  return drawTriangle\n}\n\nconst around = [\n  { dx: -1, dy: 0 },\n  { dx: 1, dy: 0 },\n  { dx: 0, dy: -1 },\n  { dx: 0, dy: 1 },\n]\n\n/**\n * Flood fill tool.\n */\nexport function fill({ x, y }, state, dispatch) {\n  let targetColor = state.picture.pixel(x, y)\n  let drawn = [{ x, y, color: state.color }]\n  for (let done = 0; done < drawn.length; done++) {\n    for (let { dx, dy } of around) {\n      // eslint-disable-next-line one-var\n      let x = drawn[done].x + dx,\n        y = drawn[done].y + dy\n      if (\n        x >= 0 &&\n        x < state.picture.width &&\n        y >= 0 &&\n        y < state.picture.height &&\n        state.picture.pixel(x, y) == targetColor &&\n        !drawn.some((p) => p.x == x && p.y == y)\n      ) {\n        drawn.push({ x, y, color: state.color })\n      }\n    }\n  }\n  dispatch({ picture: state.picture.draw(drawn) })\n}\n\n/**\n * Color picker tool\n */\nexport function pick(pos, state, dispatch) {\n  dispatch({ color: state.picture.pixel(pos.x, pos.y) })\n}\n","import { elt, hex } from '../utils'\nimport { Picture } from '../picture'\n\nexport class LoadButton {\n  constructor(_, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => startLoad(dispatch),\n      },\n      '📁 Load'\n    )\n  }\n\n  syncState() {\n    // unimplemented\n  }\n}\n\n/**\n * Gets the file from the user's computer through use of an `<input>` HTML element with the `file` attribute\n * @param {*} dispatch\n */\nfunction startLoad(dispatch) {\n  let input = elt('input', {\n    type: 'file',\n    onchange: () => finishLoad(input.files[0], dispatch),\n  })\n  document.body.appendChild(input)\n  input.click()\n  input.remove()\n}\n\n/**\n * When the user has selected a file, we use the `FileReader` to\n * get access to its contents, again as a data URL.\n * This URL can be used to create a `<img>` element; since we can't\n * get direct access to the pixels in such an image, we can't create\n * a `Picture` object from that. A call to `pictureFromImage` handles this conversion.\n * @param {*} file\n * @param {*} dispatch\n */\nfunction finishLoad(file, dispatch) {\n  if (file == null) return\n  let reader = new FileReader()\n  reader.addEventListener('load', () => {\n    let image = elt('img', {\n      onload: () =>\n        dispatch({\n          picture: pictureFromImage(image),\n        }),\n      src: reader.result,\n    })\n  })\n  reader.readAsDataURL(file)\n}\n\nfunction pictureFromImage(image) {\n  let width = Math.min(100, image.width)\n  let height = Math.min(100, image.height)\n  let canvas = elt('canvas', { width, height })\n  let ctx = canvas.getContext('2d')\n  ctx.drawImage(image, 0, 0)\n  let pixels = []\n  // this data property is an array of color components\n  // contains 4 values which represent reg, green, blue and alpha (for transparency) of the pixel's color as 8 bit numbers (0-255)\n  let { data } = ctx.getImageData(0, 0, width, height)\n\n  for (let i = 0; i < data.length; i += 4) {\n    let [r, g, b] = data.slice(i, i + 3)\n    pixels.push(`#${hex(r)}${hex(g)}${hex(b)}`)\n  }\n  return new Picture(width, height, pixels)\n}\n","import { drawPicture, elt } from '../utils'\nimport { SCALE } from './picture-canvas'\n\nexport class SaveButton {\n  constructor(state, { dispatch }) {\n    this.picture = state.picture\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => dispatch({ save: true }),\n      },\n      '💾 Save'\n    )\n  }\n\n  static save(picture) {\n    let canvas = elt('canvas')\n    drawPicture(picture, canvas, SCALE)\n    let link = elt('a', {\n      href: canvas.toDataURL(),\n      // eslint-disable-next-line no-alert\n      download: `${prompt('save file as?', 'pixel-art') ?? 'pixel-art'}.png`,\n    })\n    document.body.appendChild(link)\n    link.click()\n    link.remove()\n  }\n\n  syncState(state) {\n    this.picture = state.picture\n  }\n}\n","import { elt } from '../utils'\n\nexport class UndoButton {\n  constructor(state, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => dispatch({ undo: true }),\n        disabled: state.done.length <= 1,\n      },\n      '⤴ Undo'\n    )\n  }\n\n  syncState(state) {\n    this.dom.disabled = state.done.length <= 1\n  }\n}\n","import { elt } from '../utils'\n\nexport class RedoButton {\n  constructor(state, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => dispatch({ redo: true }),\n        disabled: state.redone.length < 1,\n      },\n      '⤵ Redo'\n    )\n  }\n\n  syncState(state) {\n    this.dom.disabled = state.redone.length < 1\n  }\n}\n","import { elt } from '../utils'\n\nexport class ResetButton {\n  constructor(state, { dispatch }) {\n    this.dom = elt(\n      'button',\n      {\n        onclick: () => {\n          // eslint-disable-next-line no-restricted-globals, no-alert\n          if (confirm('Are you sure you want to reset the canvas?')) {\n            dispatch({ reset: true })\n          }\n        },\n        disabled: !state.done.length,\n      },\n      '🔁 Reset'\n    )\n  }\n\n  syncState(state) {\n    this.dom.disabled = !state.done.length\n  }\n}\n","import { elt } from '../utils'\n\nexport class ToolSelect {\n  constructor(state, { tools, dispatch }) {\n    this.select = elt(\n      'select',\n      {\n        onchange: () => dispatch({ tool: this.select.value }),\n      },\n      ...Object.keys(tools).map((name) =>\n        elt(\n          'option',\n          {\n            selected: name == state.tool,\n          },\n          name\n        )\n      )\n    )\n    this.dom = elt('label', null, 'Tool: ', this.select)\n  }\n\n  /**\n   * Sync ToolSelect state\n   * @param {*} state\n   */\n  syncState(state) {\n    this.select.value = state.tool\n  }\n}\n","import { elt } from '../utils'\n\nexport class ColorSelect {\n  constructor(state, { dispatch }) {\n    this.input = elt('input', {\n      type: 'color',\n      value: state.color,\n      onchange: () => dispatch({ color: this.input.value }),\n    })\n    this.dom = elt('label', null, '🎨 Color: ', this.input)\n  }\n\n  /**\n   * Sync the ColorSelect state\n   * @param {*} state\n   */\n  syncState(state) {\n    this.input.value = state.color\n  }\n}\n","import { LoadButton } from './load-button'\nimport { PictureCanvas } from './picture-canvas'\nimport { SaveButton } from './save-button'\nimport { UndoButton } from './undo-button'\nimport { RedoButton } from './redo-button'\nimport { ResetButton } from './reset-button'\nimport { ToolSelect } from './tool-select'\nimport { ColorSelect } from './color-select'\n\nexport {\n  LoadButton,\n  PictureCanvas,\n  SaveButton,\n  UndoButton,\n  RedoButton,\n  ResetButton,\n  ToolSelect,\n  ColorSelect,\n}\n","import { PixelEditor } from './app'\nimport { draw, fill, pick, rectangle, circle, triangle } from './tools'\nimport {\n  LoadButton,\n  SaveButton,\n  UndoButton,\n  RedoButton,\n  ResetButton,\n  ToolSelect,\n  ColorSelect,\n} from './components'\nimport { Picture } from './picture'\nimport { cached, getCachedState } from './utils'\n\nconst INITIAL_STATE = {\n  tool: 'draw',\n  color: '#000000',\n  picture: Picture.empty(60, 30, '#f0f0f0'),\n  done: [],\n  redone: [],\n  doneAt: 0,\n}\n\nconst baseTools = {\n  draw,\n  fill,\n  pick,\n  rectangle,\n  circle,\n  triangle,\n}\n\nconst baseControls = [\n  ToolSelect,\n  ColorSelect,\n  SaveButton,\n  LoadButton,\n  UndoButton,\n  RedoButton,\n  ResetButton,\n]\n\n// quasi - reducer function\nfunction historyUpdateState(state, action) {\n  if (action.undo) {\n    if (state.done.length <= 1) return state\n    let redone = state.done.pop()\n    return cached({\n      ...state,\n      picture: state.done[state.done.length - 1],\n      done: [...state.done],\n      redone: [...state.redone, redone],\n      doneAt: 0,\n    })\n  }\n\n  if (action.redo) {\n    if (state.redone.length < 1) return state\n    let picture = state.redone.pop()\n    return cached({\n      ...state,\n      picture,\n      done: [...state.done, picture],\n      redone: [...state.redone],\n      doneAt: 0,\n    })\n  }\n\n  if (action.reset) {\n    let picture = Picture.empty(60, 30, '#f0f0f0')\n    return cached({\n      ...state,\n      picture,\n      done: [],\n      redone: [],\n    })\n  }\n\n  if (action.save) {\n    SaveButton.save(state.picture)\n    return cached({ ...state })\n  }\n\n  if (action.picture && state.doneAt < Date.now() - 1000) {\n    return cached({\n      ...state,\n      ...action,\n      done: [...state.done, state.picture],\n      // redone state only relevant on undo, otherwise it remains empty\n      // on regular picture action\n      redone: [],\n      doneAt: Date.now(),\n    })\n  }\n  return cached({ ...state, ...action })\n}\n\nfunction startPixelEditor({\n  state = getCachedState() ?? INITIAL_STATE,\n  tools = baseTools,\n  controls = baseControls,\n}) {\n  const app = new PixelEditor(state, {\n    tools,\n    controls,\n    dispatch(action) {\n      state = historyUpdateState(state, action)\n      app.syncState(state)\n    },\n  })\n  return app.dom\n}\n\nconsole.info('Fork me on github: https://github.com/collinsmuriuki/pixie')\ndocument.getElementById('root').appendChild(startPixelEditor({}))\n"]}